<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta content="LaTeX Lwarp package" name="generator" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Writing Graph Drawing Algorithms in C - PGF/TikZ Manual</title>
    <link href="style.css" rel="stylesheet" type="text/css" />

    <script>
      // Lwarp MathJax emulation code
      //
      // Based on code by Davide P. Cervone.
      // Equation numbering: https://github.com/mathjax/MathJax/issues/2427
      // Starred and ifnextchar macros: https://github.com/mathjax/MathJax/issues/2428
      // \left, \right delimiters: https://github.com/mathjax/MathJax/issues/2535
      //
      // Modified by Brian Dunn to adjust equation numbering and add subequations.
      //
      // LaTeX can use \seteqnumber{subequations?}{section}{number} before each equation.
      // subequations? is 0 usually, 1 if inside subequations.
      // section is a string printed as-is, or empty.
      // number is auto-incremented by MathJax between equations.
      //
      MathJax = {
        subequations: "0",
        section: "",
        loader: {
          load: ["[tex]/tagformat", "[tex]/textmacros"],
        },
        startup: {
          ready() {
            // These would be replaced by import commands if you wanted to make
            // a proper extension.
            const Configuration =
              MathJax._.input.tex.Configuration.Configuration;
            const CommandMap = MathJax._.input.tex.SymbolMap.CommandMap;
            const Macro = MathJax._.input.tex.Symbol.Macro;
            const TexError = MathJax._.input.tex.TexError.default;
            const ParseUtil = MathJax._.input.tex.ParseUtil.default;
            const expandable = MathJax._.util.Options.expandable;

            // Insert the replacement string into the TeX string, and check
            // that there haven't been too many maxro substitutions (prevents
            // infinite loops).
            const useArgument = (parser, text) => {
              parser.string = ParseUtil.addArgs(
                parser,
                text,
                parser.string.slice(parser.i)
              );
              parser.i = 0;
              if (
                ++parser.macroCount > parser.configuration.options.maxMacros
              ) {
                throw new TexError(
                  "MaxMacroSub1",
                  "MathJax maximum macro substitution count exceeded; " +
                    "is there a recursive macro call?"
                );
              }
            };

            // Create the command map for:
            // \ifstar, \ifnextchar, \ifblank, \ifstrequal, \seteqnumber
            new CommandMap(
              "Lwarp-macros",
              {
                ifstar: "IfstarFunction",
                ifnextchar: "IfnextcharFunction",
                ifblank: "IfblankFunction",
                ifstrequal: "IfstrequalFunction",
                seteqnumber: "SeteqnumberFunction",
              },
              {
                // This function implements an ifstar macro.
                IfstarFunction(parser, name) {
                  const resultstar = parser.GetArgument(name);
                  const resultnostar = parser.GetArgument(name);
                  const star = parser.GetStar(); // true if there is a *
                  useArgument(parser, star ? resultstar : resultnostar);
                },

                // This function implements an ifnextchar macro.
                IfnextcharFunction(parser, name) {
                  let whichchar = parser.GetArgument(name);
                  if (whichchar.match(/^(?:0x[0-9A-F]+|[0-9]+)$/i)) {
                    // $ syntax highlighting
                    whichchar = String.fromCodePoint(parseInt(whichchar));
                  }
                  const resultnextchar = parser.GetArgument(name);
                  const resultnotnextchar = parser.GetArgument(name);
                  const gotchar = parser.GetNext() === whichchar;
                  useArgument(
                    parser,
                    gotchar ? resultnextchar : resultnotnextchar
                  );
                },

                // This function implements an ifblank macro.
                IfblankFunction(parser, name) {
                  const blankarg = parser.GetArgument(name);
                  const resultblank = parser.GetArgument(name);
                  const resultnotblank = parser.GetArgument(name);
                  const isblank = blankarg.trim() == "";
                  useArgument(parser, isblank ? resultblank : resultnotblank);
                },

                // This function implements an ifstrequal macro.
                IfstrequalFunction(parser, name) {
                  const strequalfirst = parser.GetArgument(name);
                  const strequalsecond = parser.GetArgument(name);
                  const resultequal = parser.GetArgument(name);
                  const resultnotequal = parser.GetArgument(name);
                  const isequal = strequalfirst == strequalsecond;
                  useArgument(parser, isequal ? resultequal : resultnotequal);
                },

                // This function modifies the equation numbers.
                SeteqnumberFunction(parser, name) {
                  // Get the macro parameters
                  const star = parser.GetStar(); // true if there is a *
                  const optBrackets = parser.GetBrackets(name); // contents of optional brackets
                  const newsubequations = parser.GetArgument(name); // the subequations argument
                  const neweqsection = parser.GetArgument(name); // the eq section argument
                  const neweqnumber = parser.GetArgument(name); // the eq number argument
                  MathJax.config.subequations = newsubequations; // a string with boolean meaning
                  MathJax.config.section = neweqsection; // a string with numeric meaning
                  parser.tags.counter = parser.tags.allCounter = neweqnumber;
                },
              }
            );

            // Create the Lwarp-macros package
            Configuration.create("Lwarp-macros", {
              handler: { macro: ["Lwarp-macros"] },
            });

            MathJax.startup.defaultReady();

            // For forward references:
            MathJax.startup.input[0].preFilters.add(({ math }) => {
              if (math.inputData.recompile) {
                MathJax.config.subequations =
                  math.inputData.recompile.subequations;
                MathJax.config.section = math.inputData.recompile.section;
              }
            });
            MathJax.startup.input[0].postFilters.add(({ math }) => {
              if (math.inputData.recompile) {
                math.inputData.recompile.subequations =
                  MathJax.config.subequations;
                math.inputData.recompile.section = MathJax.config.section;
              }
            });

            // For \left, \right with unicode-math:
            const { DelimiterMap } = MathJax._.input.tex.SymbolMap;
            const { Symbol } = MathJax._.input.tex.Symbol;
            const { MapHandler } = MathJax._.input.tex.MapHandler;
            const delimiter = MapHandler.getMap("delimiter");
            delimiter.add("\\lBrack", new Symbol("\\lBrack", "\u27E6"));
            delimiter.add("\\rBrack", new Symbol("\\rBrack", "\u27E7"));
            delimiter.add("\\lAngle", new Symbol("\\lAngle", "\u27EA"));
            delimiter.add("\\rAngle", new Symbol("\\rAngle", "\u27EB"));
            delimiter.add("\\lbrbrak", new Symbol("\\lbrbrak", "\u2772"));
            delimiter.add("\\rbrbrak", new Symbol("\\rbrbrak", "\u2773"));
            delimiter.add("\\lbag", new Symbol("\\lbag", "\u27C5"));
            delimiter.add("\\rbag", new Symbol("\\rbag", "\u27C6"));
            delimiter.add(
              "\\llparenthesis",
              new Symbol("\\llparenthesis", "\u2987")
            );
            delimiter.add(
              "\\rrparenthesis",
              new Symbol("\\rrparenthesis", "\u2988")
            );
            delimiter.add("\\llangle", new Symbol("\\llangle", "\u2989"));
            delimiter.add("\\rrangle", new Symbol("\\rrangle", "\u298A"));
            delimiter.add("\\Lbrbrak", new Symbol("\\Lbrbrak", "\u27EC"));
            delimiter.add("\\Rbrbrak", new Symbol("\\Rbrbrak", "\u27ED"));
            delimiter.add("\\lBrace", new Symbol("\\lBrace", "\u2983"));
            delimiter.add("\\rBrace", new Symbol("\\rBrace", "\u2984"));
            delimiter.add("\\lParen", new Symbol("\\lParen", "\u2985"));
            delimiter.add("\\rParen", new Symbol("\\rParen", "\u2986"));
            delimiter.add("\\lbrackubar", new Symbol("\\lbrackubar", "\u298B"));
            delimiter.add("\\rbrackubar", new Symbol("\\rbrackubar", "\u298C"));
            delimiter.add(
              "\\lbrackultick",
              new Symbol("\\lbrackultick", "\u298D")
            );
            delimiter.add(
              "\\rbracklrtick",
              new Symbol("\\rbracklrtick", "\u298E")
            );
            delimiter.add(
              "\\lbracklltick",
              new Symbol("\\lbracklltick", "\u298F")
            );
            delimiter.add(
              "\\rbrackurtick",
              new Symbol("\\rbrackurtick", "\u2990")
            );
            delimiter.add("\\langledot", new Symbol("\\langledot", "\u2991"));
            delimiter.add("\\rangledot", new Symbol("\\rangledot", "\u2992"));
            delimiter.add("\\lparenless", new Symbol("\\lparenless", "\u2993"));
            delimiter.add("\\rparengtr", new Symbol("\\rparengtr", "\u2994"));
            delimiter.add("\\Lparengtr", new Symbol("\\Lparengtr", "\u2995"));
            delimiter.add("\\Rparenless", new Symbol("\\Rparenless", "\u2996"));
            delimiter.add("\\lblkbrbrak", new Symbol("\\lblkbrbrak", "\u2997"));
            delimiter.add("\\rblkbrbrak", new Symbol("\\rblkbrbrak", "\u2998"));
            delimiter.add("\\lvzigzag", new Symbol("\\lvzigzag", "\u29D8"));
            delimiter.add("\\rvzigzag", new Symbol("\\rvzigzag", "\u29D9"));
            delimiter.add("\\Lvzigzag", new Symbol("\\Lvzigzag", "\u29DA"));
            delimiter.add("\\Rvzigzag", new Symbol("\\Rvzigzag", "\u29DB"));
            delimiter.add(
              "\\lcurvyangle",
              new Symbol("\\lcurvyangle", "\u29FC")
            );
            delimiter.add(
              "\\rcurvyangle",
              new Symbol("\\rcurvyangle", "\u29FD")
            );
            delimiter.add("\\Vvert", new Symbol("\\Vvert", "\u2980"));
          }, // ready
        }, // startup

        tex: {
          packages: { "[+]": ["tagformat", "Lwarp-macros", "textmacros"] },
          tags: "ams",
          tagformat: {
            number: function (n) {
              if (MathJax.config.subequations == 0)
                return MathJax.config.section + n;
              else return MathJax.config.section + String.fromCharCode(96 + n);
            },
          },
        },
      };
    </script>

    <script
      async
      id="MathJax-script"
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"
    ></script>

    <script src="pgfmanual.js"></script>

    <link href="https://unpkg.com/@docsearch/css@alpha" rel="stylesheet" />
    <link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png" />
    <link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png" />
    <link
      href="/apple-touch-icon.png"
      rel="apple-touch-icon"
      sizes="180x180"
      type="image/png"
    />
    <link href="/site.webmanifest" rel="manifest" />
  </head>
  <body>
    <a id="pgfmanual-autopage-4854"></a>

    <div class="bodyandsidetoc grid-container">
      <header>
        <strong><a href="/">PGF/Ti<i>k</i>Z Manual</a></strong>
        <div id="search"></div>
      </header>
      <div class="sidetoccontainer" id="local-toc-container">
        <nav class="sidetoc">
          <div class="sidetoctitle"><p>On this page</p></div>
          <div class="sidetoccontents">
            <p>
              <a class="tocsubsection" href="#sec-37.1"
                >How C and TeX Communicate</a
              >
            </p>
            <p>
              <a class="tocsubsection" href="#sec-37.2"
                >Writing Graph Drawing Algorithms in C</a
              >
            </p>
            <p>
              <a class="tocsubsubsection" href="#sec-37.2.1"
                >The Hello World of Graph Drawing in C</a
              >
            </p>
            <p>
              <a class="tocsubsubsection" href="#sec-37.2.2"
                >Documenting Algorithms Written in C</a
              >
            </p>
            <p>
              <a class="tocsubsubsection" href="#sec-37.2.3"
                >The Interface From C</a
              >
            </p>
            <p>
              <a class="tocsubsection" href="#sec-37.3"
                >Writing Graph Drawing Algorithms in C++</a
              >
            </p>
            <p>
              <a class="tocsubsubsection" href="#sec-37.3.1"
                >The Hello World of Graph Drawing in C++</a
              >
            </p>
            <p>
              <a class="tocsubsubsection" href="#sec-37.3.2"
                >The Interface From C++</a
              >
            </p>
            <p>
              <a class="tocsubsection" href="#sec-37.4"
                >Writing Graph Drawing Algorithms Using OGDF</a
              >
            </p>
            <p>
              <a class="tocsubsubsection" href="#sec-37.4.1"
                >The Hello World of Graph Drawing in OGDF &ndash; From
                Scratch</a
              >
            </p>
            <p>
              <a class="tocsubsubsection" href="#sec-37.4.2"
                >The Hello World of Graph Drawing in OGDF &ndash; Adapting
                Existing Classes</a
              >
            </p>
            <p>
              <a class="tocsubsubsection" href="#sec-37.4.3"
                >Documenting OGDF Algorithms</a
              >
            </p>
            <p>
              <a class="tocsubsubsection" href="#sec-37.4.4"
                >The Interface From OGDF</a
              >
            </p>
          </div>
        </nav>
      </div>
      <div class="sidetoccontainer" id="chapter-toc-container">
        <nav class="sidetoc">
          <div class="sidetoctitle">
            <p>
              <span class="sidetocthetitle"
                >The <span class="tikzname">TikZ</span> and PGF Packages<br />
                Manual for version 3.1.9a</span
              >
            </p>

            <p>Contents</p>
          </div>

          <div class="sidetoccontents">
            <p></p>

            <p>
              <a class="linkintro" href="/">Introduction</a>
            </p>

            <p>
              <a class="tocpart" href="tutorials-guidelines"
                >Tutorials and Guidelines</a
              >
            </p>

            <p>
              <a class="tocpart" href="install"
                >Installation and Configuration</a
              >
            </p>

            <p>
              <a class="tocpart" href="tikz">Ti<em>k</em>Z</a>
            </p>

            <p class="current-part">
              <a class="tocpart" href="gd">Graph Drawing</a>
            </p>

            <p class="current-part">
              <a class="tocsection" href="gd-overview"
                >Introduction to Algorithmic Graph Drawing</a
              >
            </p>

            <p class="current-part">
              <a class="tocsection" href="gd-usage-tikz"
                >Using Graph Drawing in <span class="tikzname">TikZ</span></a
              >
            </p>

            <p class="current-part">
              <a class="tocsection" href="gd-usage-pgf"
                >Using Graph Drawing in PGF</a
              >
            </p>

            <p class="current-part">
              <a class="tocsection" href="gd-trees"
                >Graph Drawing Layouts: Trees</a
              >
            </p>

            <p class="current-part">
              <a class="tocsection" href="gd-layered"
                >Graph Drawing Algorithms: Layered Layouts</a
              >
            </p>

            <p class="current-part">
              <a class="tocsection" href="gd-force"
                >Graph Drawing Algorithms: Force-Based Methods</a
              >
            </p>

            <p class="current-part">
              <a class="tocsection" href="gd-circular"
                >Graph Drawing Algorithms: Circular Layouts</a
              >
            </p>

            <p class="current-part">
              <a class="tocsection" href="gd-phylogenetics"
                >Graph Drawing Layouts: Phylogenetic Trees</a
              >
            </p>

            <p class="current-part">
              <a class="tocsection" href="gd-edge-routing"
                >Graph Drawing Algorithms: Edge Routing</a
              >
            </p>

            <p class="current-part">
              <a class="tocsection" href="gd-algorithm-layer"
                >The Algorithm Layer</a
              >
            </p>

            <p class="current current-part">
              <a class="tocsection" href="gd-algorithms-in-c"
                >Writing Graph Drawing Algorithms in C</a
              >
            </p>

            <p class="current-part">
              <a class="tocsection" href="gd-display-layer"
                >The Display Layer</a
              >
            </p>

            <p class="current-part">
              <a class="tocsection" href="gd-binding-layer"
                >The Binding Layer</a
              >
            </p>

            <p>
              <a class="tocpart" href="libraries">Libraries</a>
            </p>

            <p>
              <a class="tocpart" href="dv">Data Visualization</a>
            </p>

            <p>
              <a class="tocpart" href="utilities">Utilities</a>
            </p>

            <p>
              <a class="tocpart" href="math"
                >Mathematical and Object-Oriented Engines</a
              >
            </p>

            <p>
              <a class="tocpart" href="base">The Basic Layer</a>
            </p>

            <p>
              <a class="tocpart" href="pgfsys">The System Layer</a>
            </p>
          </div>
        </nav>
      </div>

      <main class="bodycontainer">
        <section class="textbody">
          <h1>
            The <span class="tikzname">TikZ</span> and PGF Packages<br />
            Manual for version 3.1.9a
          </h1>
          <h2 class="inserted">Graph Drawing</h2>

          <!--MathJax customizations:-->

          <div class="hidden">
            \(\newcommand{\footnotename}{footnote}\) \(\def \LWRfootnote {1}\)
            \(\newcommand {\footnote }[2][\LWRfootnote ]{{}^{\mathrm {#1}}}\)
            \(\newcommand {\footnotemark }[1][\LWRfootnote ]{{}^{\mathrm
            {#1}}}\) \(\let \LWRorighspace \hspace \) \(\renewcommand {\hspace
            }{\ifstar \LWRorighspace \LWRorighspace }\) \(\newcommand
            {\mathnormal }[1]{{#1}}\) \(\newcommand \ensuremath [1]{#1}\)
            \(\newcommand {\LWRframebox }[2][]{\fbox {#2}} \newcommand
            {\framebox }[1][]{\LWRframebox } \) \(\newcommand {\setlength
            }[2]{}\) \(\newcommand {\addtolength }[2]{}\) \(\newcommand
            {\setcounter }[2]{}\) \(\newcommand {\addtocounter }[2]{}\)
            \(\newcommand {\arabic }[1]{}\) \(\newcommand {\number }[1]{}\)
            \(\newcommand {\noalign }[1]{\text {#1}\notag \\}\) \(\newcommand
            {\cline }[1]{}\) \(\newcommand {\directlua }[1]{\text
            {(directlua)}}\) \(\newcommand {\luatexdirectlua }[1]{\text
            {(directlua)}}\) \(\newcommand {\protect }{}\) \(\def
            \LWRabsorbnumber #1 {}\) \(\def \LWRabsorbquotenumber "#1 {}\)
            \(\newcommand {\LWRabsorboption }[1][]{}\) \(\newcommand
            {\LWRabsorbtwooptions }[1][]{\LWRabsorboption }\) \(\def \mathchar
            {\ifnextchar "\LWRabsorbquotenumber \LWRabsorbnumber }\) \(\def
            \mathcode #1={\mathchar }\) \(\let \delcode \mathcode \) \(\let
            \delimiter \mathchar \) \(\def \oe {\unicode {x0153}}\) \(\def \OE
            {\unicode {x0152}}\) \(\def \ae {\unicode {x00E6}}\) \(\def \AE
            {\unicode {x00C6}}\) \(\def \aa {\unicode {x00E5}}\) \(\def \AA
            {\unicode {x00C5}}\) \(\def \o {\unicode {x00F8}}\) \(\def \O
            {\unicode {x00D8}}\) \(\def \l {\unicode {x0142}}\) \(\def \L
            {\unicode {x0141}}\) \(\def \ss {\unicode {x00DF}}\) \(\def \SS
            {\unicode {x1E9E}}\) \(\def \dag {\unicode {x2020}}\) \(\def \ddag
            {\unicode {x2021}}\) \(\def \P {\unicode {x00B6}}\) \(\def
            \copyright {\unicode {x00A9}}\) \(\def \pounds {\unicode {x00A3}}\)
            \(\let \LWRref \ref \) \(\renewcommand {\ref }{\ifstar \LWRref
            \LWRref }\) \( \newcommand {\multicolumn }[3]{#3}\) \(\require
            {textcomp}\) \( \newcommand {\meta }[1]{\langle \textit {#1}\rangle
            } \) \(\newcommand {\intertext }[1]{\text {#1}\notag \\}\) \(\let
            \Hat \hat \) \(\let \Check \check \) \(\let \Tilde \tilde \) \(\let
            \Acute \acute \) \(\let \Grave \grave \) \(\let \Dot \dot \) \(\let
            \Ddot \ddot \) \(\let \Breve \breve \) \(\let \Bar \bar \) \(\let
            \Vec \vec \)
          </div>

          <p></p>
          <h4 id="autosec-4855">
            <a id="section-algorithms-in-c"></a
            ><span class="sectionnumber">37&emsp;</span>Writing Graph Drawing
            Algorithms in C
          </h4>
          <a id="pgfmanual-autopage-4855"></a>
          <a id="pgfmanual-autofile-41"></a>

          <p>
            <em>by Till Tantau</em>
          </p>

          <p>
            In the present section we have a look at how graph drawing
            algorithms written in the C programming language (or in C++) can be
            used in the graph drawing framework.
          </p>
          <blockquote>
            <p>
              <em>Warning:</em> Graph drawing algorithms written in C can be
              incredibly fast if you use the facilities of C correctly.
              <em>However,</em> C code is much less portable than Lua code in
              the sense that it has to be compiled for the specific platform
              used by the user and that it has to be linked dynamically during a
              run of the
              <span class="latexlogofont"
                ><span class="latexlogo"
                  >T<span class="latexlogosub">e</span>X</span
                ></span
              >
              program. All of this in possible (and works, as demonstrated by
              the linking of the <span class="textsc">ogdf</span> framework),
              but it is <em>much</em> harder to get right than writing Lua code.
            </p>

            <p>
              Bottom line,
              <em
                >you really should be using this method only if it is really
                necessary (namely, when Lua code is simply not fast enough).</em
              >
            </p>
          </blockquote>

          <p>
            In the following, I first explain how the link between
            <span class="latexlogofont"
              ><span class="latexlogo"
                >T<span class="latexlogosub">e</span>X</span
              ></span
            >
            and C code works, in general. Then, in the subsequent sections, we
            go over the different kinds of programming languages and frameworks
            for which there is direct support for such a link.
          </p>
          <h5 id="autosec-4857">
            <span class="sectionnumber" id="sec-37.1">37.1&emsp;</span>How C and
            <span class="latexlogofont"
              ><span class="latexlogo"
                >T<span class="latexlogosub">e</span>X</span
              ></span
            >
            Communicate<a class="anchor-link" href="#sec-37.1">&para;</a>
          </h5>
          <a id="pgfmanual-autopage-4857"></a>

          <p>
            In order to use C code for graph drawing algorithms during a run of
            the
            <span class="latexlogofont"
              ><span class="latexlogo"
                >T<span class="latexlogosub">e</span>X</span
              ></span
            >
            program, there is no need to build a new version of
            <span class="latexlogofont"
              ><span class="latexlogo"
                >T<span class="latexlogosub">e</span>X</span
              ></span
            >. Rather, it is possible that C code is linked into the
            <span class="latexlogofont"
              ><span class="latexlogo"
                >T<span class="latexlogosub">e</span>X</span
              ></span
            >
            executable at runtime. This is made possible by the fact that Lua
            (which part of Lua<span class="latexlogofont"
              ><span class="latexlogo"
                >T<span class="latexlogosub">e</span>X</span
              ></span
            >\(\dots \)) is able to link C libraries at runtime &ndash; provided
            a strict regime of rules is adhered to:
          </p>
          <ul style="list-style-type: none">
            <li>
              <p>
                1. When you say <span class="texttt">require</span> in Lua, it
                will normally look for a <span class="texttt">.lua</span> file;
                but it will also try to find a
                <span class="texttt">.so</span> file (a shared C library) as a
                fallback.
              </p>
            </li>
            <li>
              <p>
                2. If it finds such a shared library, Lua(<span
                  class="latexlogofont"
                  ><span class="latexlogo"
                    >T<span class="latexlogosub">e</span>X</span
                  ></span
                >) will try to link this library dynamically at runtime.
              </p>
            </li>
            <li>
              <p>
                3. Inside the library, there must be a function (called an entry
                point) with a special name (it must start with
                <span class="texttt">luaopen_</span> and it must otherwise be
                the path and name of the library with slashes replaced by
                underscores).
              </p>
            </li>
            <li>
              <p>
                4. This function gets called by Lua, once. Its job is to setup
                the library so that it can be used by Lua. Mainly, this means
                that certain C functions get registered in such a way that Lua
                can call them.
              </p>
            </li>
            <li>
              <p>
                5. At this point, control returns to Lua and, now, certain
                functions have become available on the Lua layer that, when
                called, actually invoke the C code of our linked library.
              </p>
            </li>
          </ul>

          <p>
            For each of the above points, there are some bells and whistles:
          </p>
          <ul style="list-style-type: none">
            <li>
              <p>
                1. Lua<span class="latexlogofont"
                  ><span class="latexlogo"
                    >T<span class="latexlogosub">e</span>X</span
                  ></span
                >
                looks at slightly inconvenient places for shared libraries: By
                default, (currently, 2013) it looks in a
                <span class="texttt">lib</span> subdirectory of the directory
                containing the Lua<span class="latexlogofont"
                  ><span class="latexlogo"
                    >T<span class="latexlogosub">e</span>X</span
                  ></span
                >
                executable. The logic behind is that the shared libraries depend
                on the specific architecture of the executable. Thus, unlike
                normal Lua files, the library needs to be installed &ldquo;far
                away&rdquo; from the actual package of which it is part.
              </p>
            </li>
            <li>
              <p>
                2. Certain versions of Lua<span class="latexlogofont"
                  ><span class="latexlogo"
                    >T<span class="latexlogosub">e</span>X</span
                  ></span
                >
                have a broken handling of filenames of libraries written in C.
                The TL2013 version of Lua<span class="latexlogofont"
                  ><span class="latexlogo"
                    >T<span class="latexlogosub">e</span>X</span
                  ></span
                >, for instance, crashes when the filename of a shared library
                does not contain the complete path (while this works for normal
                file). Hopefully, this, too, will be fixed in future versions.
              </p>
            </li>
            <li>
              <p>
                3. On certain platforms, the support for dynamic linking against
                Lua<span class="latexlogofont"
                  ><span class="latexlogo"
                    >T<span class="latexlogosub">e</span>X</span
                  ></span
                >
                is broken since the symbol table of the Lua library has been
                stripped away. Hopefully, this will be fixed soon; in the
                meantime, a highly fragile workaround is to link in another copy
                of the Lua library.
              </p>
            </li>
            <li>
              <p>
                4. The entry point that is called by Lua requires a certain
                signature (it takes a Lua state as its only parameter) and must
                return the number of objects it returns on the Lua stack.
              </p>
            </li>
            <li>
              <p>
                5. The registration process of C functions is somewhat tricky
                and changes from Lua version to Lua version.
              </p>
            </li>
            <li>
              <p>
                6. C functions that get called by Lua must follow all sorts of
                tricky rules in order to communicate with Lua correctly.
              </p>
            </li>
          </ul>

          <p>
            Despite the above obstacles, one can use graph drawing algorithms
            written in C inside Lua, in principle, as follows: One loads an
            appropriately prepared and located C library using
            <span class="texttt">require</span> and this library uses commands
            like <span class="texttt">declare</span> to register its own
            functions into the graph drawing system so that when the
            <span class="texttt">run</span> method is called, a C functions gets
            called instead.
          </p>

          <p>
            Unfortunately, the above approach is extremely tedious and
            error-prone and it is &ldquo;no fun&rdquo; to access Lua data
            structures (such as the syntactic digraph) from C. For this reason,
            I have written some libraries that encapsulate (as much as possible)
            of this communication between C and Lua. Indeed, when you use these
            libraries, you can focus entirely on the graph drawing issues and
            you will not even notice that your code &ldquo;is talking to
            Lua&rdquo;. (Except for the name of the entry point, which is fixed
            to start with <span class="texttt">luaopen_</span> and it is
            impossible to change this without disrupting a lot inside
            Lua&rsquo;s module system).
          </p>

          <p>
            There are libraries available for simplifying the communication
            between the graph drawing system and graph drawing algorithms
            written in
          </p>
          <ul style="list-style-type: none">
            <li>
              <p>
                &bull; C, see Section&nbsp;<a
                  href="gd-algorithms-in-c#section-gd-c"
                  >37.2</a
                >,
              </p>
            </li>
            <li>
              <p>
                &bull; C++, see Section&nbsp;<a
                  href="gd-algorithms-in-c#section-gd-c++"
                  >37.3</a
                >,
              </p>
            </li>
            <li>
              <p>
                &bull; Open Graph Drawing Framework, see Section&nbsp;<a
                  href="gd-algorithms-in-c#section-gd-ogdf-interface"
                  >37.4</a
                >.
              </p>
            </li>
          </ul>
          <h5 id="autosec-4858">
            <a id="section-gd-c"></a
            ><span class="sectionnumber" id="sec-37.2">37.2&emsp;</span>Writing
            Graph Drawing Algorithms in C<a class="anchor-link" href="#sec-37.2"
              >&para;</a
            >
          </h5>
          <a id="pgfmanual-autopage-4858"></a>

          <h6 id="autosec-4859">
            <span class="sectionnumber" id="sec-37.2.1">37.2.1&emsp;</span>The
            Hello World of Graph Drawing in C<a
              class="anchor-link"
              href="#sec-37.2.1"
              >&para;</a
            >
          </h6>
          <a id="pgfmanual-autopage-4859"></a>

          <p>
            As our first example, as always, the &ldquo;hello world&rdquo; of
            graph drawing simply places nodes on a circle. For this, we
            implement a function <span class="texttt">fast_hello_world</span> in
            a file <span class="texttt">SimpleDemoC.c</span>. It starts as
            follows:
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000">#include</span>
                <span class="textcolor" style="color: #000000"
                  ><pgf c gd interface interfacefromc< span
                    >.<span class="textcolor" style="color: #000000">h&gt;</span
                    ><br />
                    <span class="textcolor" style="color: #000000"
                      >#include</span
                    >
                    <span class="textcolor" style="color: #000000"
                      ><math< span
                        >.<span class="textcolor" style="color: #000000"
                          >h&gt;</span
                        ><br />
                        <br />
                        <span class="textcolor" style="color: #000000"
                          >static</span
                        >
                        <span class="textcolor" style="color: #000000"
                          >void</span
                        >
                        <span class="textcolor" style="color: #000000"
                          >fast_hello_world</span
                        >
                        <span class="textcolor" style="color: #800080"
                          >(pgfgd_SyntacticDigraph* graph)</span
                        >&numsp;{<br />
                        &numsp;&numsp;...<br />
                        }<br /> </math<></span></pgf></span
              ></code>
            </div>
          </figure>

          <p>
            As we can see, we first include a special header file of a rather
            small library that does all the hard work of translating between Lua
            and C for us (<span class="texttt">InterfaceFromC</span>). These
            header files reside in the
            <span class="texttt">c</span> subdirectory of the
            <span class="texttt">pgf</span> package. Note that we do
            <em>not</em> have to include the headers of the Lua library; indeed,
            you do not need access to the source of Lua to use the interface
            headers. As a side effect, we will, however, have to write
            <span class="texttt">struct lua_State</span> instead of the more
            common <span class="texttt">lua_State</span> once in our code,
            namely in the declaration of the entry point; but that is the only
            downside.
          </p>

          <p>
            The library <span class="texttt">InterfaceFromC</span> declares the
            type <span class="texttt">pgfgd_SyntacticDigraph</span>. In a
            moment, we will see that we can setup a key
            <span class="texttt">fast simple demo layout</span> such that when
            this key is used on the display layer, the function
            <span class="texttt">fast_hello_world</span> gets called. When it is
            called, the <span class="texttt">graph</span> parameter will be a
            full representation of the to-be-laid-out graph. We can access the
            fields of the graph and even directly modify some of its fields (in
            particular, we can modify the <span class="texttt">pos</span> fields
            of the vertices). Here is the complete code of the algorithm:
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000">static</span>
                <span class="textcolor" style="color: #000000">void</span>
                <span class="textcolor" style="color: #000000"
                  >fast_hello_world</span
                >
                <span class="textcolor" style="color: #800080"
                  >(pgfgd_SyntacticDigraph* graph)</span
                >&numsp;{<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  ><a href="tikz-actions#pgf.double">double</a></span
                >
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.angle">angle</a></span
                >
                &numsp;<span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000">6</span>.<span
                  class="textcolor"
                  style="color: #000000"
                  >28318530718</span
                >
                <span class="textcolor" style="color: #000000">/</span>
                <span class="textcolor" style="color: #000000"
                  >graph-&gt;vertices</span
                >.<span class="textcolor" style="color: #000000"
                  ><a href="tikz-arrows#pgf.length">length</a></span
                >;<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  ><a href="tikz-actions#pgf.double">double</a></span
                >
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.radius">radius</a></span
                >
                <span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000"
                  >pgfgd_tonumber</span
                ><span class="textcolor" style="color: #800080"
                  >(graph-&gt;options, "fast simple demo radius")</span
                >;<br />
                <br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >int</span
                >
                <span class="textcolor" style="color: #000000">i</span>;<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >for</span
                >
                <span class="textcolor" style="color: #800080"
                  >(i = 0; i &lt; graph-&gt;vertices.length; i++)</span
                >&numsp;{<br />
                &numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >pgfgd_Vertex*</span
                >
                <span class="textcolor" style="color: #000000">v</span>
                <span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000"
                  >graph-&gt;vertices</span
                >.<span class="textcolor" style="color: #000000">array</span
                >[<span class="textcolor" style="color: #008000">i</span
                >];<br />
                &numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >v-&gt;pos</span
                >.<span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.x">x</a></span
                >
                <span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.cos">cos</a></span
                ><span class="textcolor" style="color: #800080">(angle*i)</span
                >&numsp;<span class="textcolor" style="color: #000000">*</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.radius">radius</a></span
                >;<br />
                &numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >v-&gt;pos</span
                >.<span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.y">y</a></span
                >
                <span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.sin">sin</a></span
                ><span class="textcolor" style="color: #800080">(angle*i)</span
                >&numsp;<span class="textcolor" style="color: #000000">*</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.radius">radius</a></span
                >;<br />
                &numsp;&numsp;}<br />
                }<br />
              </code>
            </div>
          </figure>

          <p>
            That is all that is needed; the C library will take care of both
            creating the <span class="texttt">graph</span> object as all well as
            of deleting it and of copying back the computed values of the
            <span class="texttt">pos</span> fields of the vertices.
          </p>

          <p>
            Our next task is to setup the key
            <span class="texttt">fast simple demo layout</span>. We can (and
            must) also do this from C, using the following code:
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000">int</span>
                <span class="textcolor" style="color: #000000"
                  >luaopen_pgf_gd_examples_c_SimpleDemoC</span
                >
                <span class="textcolor" style="color: #800080"
                  >(struct lua_State *state)</span
                >&numsp;{<br />
                <br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >pgfgd_Declaration*</span
                >
                <span class="textcolor" style="color: #000000">d</span>
                <span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000"
                  >pgfgd_new_key</span
                >
                <span class="textcolor" style="color: #800080"
                  >("fast simple demo layout")</span
                >;<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >pgfgd_key_summary</span
                >
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #800080"
                  >(d, "The C version of the hello world of graph
                  drawing")</span
                >;<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >pgfgd_key_algorithm</span
                >
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #800080"
                  >(d, fast_hello_world)</span
                >;<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >pgfgd_key_add_precondition</span
                >
                <span class="textcolor" style="color: #800080"
                  >(d, "connected")</span
                >;<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >pgfgd_key_add_precondition</span
                >
                <span class="textcolor" style="color: #800080">(d, "tree")</span
                >;<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >pgfgd_declare</span
                >
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #800080"
                  >(state, d)</span
                ><br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >pgfgd_free_key</span
                >
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #800080"
                  >(d)</span
                >;<br />
              </code>
            </div>
          </figure>

          <p>
            The function
            <span class="texttt">luaopen_pgf_gd_examples_c_SimpleDemoC</span> is
            the function that will be called by Lua (we will come to that). More
            important for us, at the moment, is the declaration of the key: We
            use <span class="texttt">pgfgd_new_key</span> to create a
            declaration record and then fill the different fields using
            appropriate function calls. In particular, the call
            <span class="texttt">pgfgd_key_algorithm</span> allows us to link
            the key with a particular C function. The
            <span class="texttt">pgfgd_declare</span> will then pass the whole
            declaration back to Lua, so the effect of the above is essentially
            the same as if you had written in Lua:
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.declare">declare</a></span
                >
                {<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >key</span
                >
                <span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000">"fast</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.simple">simple</a></span
                >
                <span class="textcolor" style="color: #000000">demo</span>
                <span class="textcolor" style="color: #000000">layout"</span
                >,<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >summary</span
                >
                <span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000">"The</span>
                <span class="textcolor" style="color: #000000">C</span>
                <span class="textcolor" style="color: #000000">version</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.of">of</a></span
                >
                <span class="textcolor" style="color: #000000">the</span>
                <span class="textcolor" style="color: #000000">hello</span>
                <span class="textcolor" style="color: #000000">world</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.of">of</a></span
                >
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.graph">graph</a></span
                >
                <span class="textcolor" style="color: #000000">drawing"</span
                >,<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >preconditions</span
                >
                <span class="textcolor" style="color: #000000">=</span> {<br />
                &numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >connected</span
                >
                <span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="pgfkeys#pgf.true">true</a></span
                >,<br />
                &numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >tree</span
                >
                <span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="pgfkeys#pgf.true">true</a></span
                >,<br />
                &numsp;&numsp;},<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >algorithm</span
                >
                <span class="textcolor" style="color: #000000">=</span> {<br />
                &numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >run</span
                >
                <span class="textcolor" style="color: #000000">=</span>
                &numsp;<span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.--">--</a></span
                >
                <span class="textcolor" style="color: #000000">something</span>
                <span class="textcolor" style="color: #000000">magic</span>
                <span class="textcolor" style="color: #000000">we</span>
                <span class="textcolor" style="color: #000000">cannot</span>
                <span class="textcolor" style="color: #000000">express</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="library-edges#pgf.in">in</a></span
                >
                <span class="textcolor" style="color: #000000">Lua</span><br />
                &numsp;&numsp;}<br />
                }<br />
              </code>
            </div>
          </figure>

          <p>
            In our algorithm, in addition to the above key, we also use the
            <span class="texttt">fast simple demo radius</span> key, which is a
            simple length key. This key, too, can be declared on the C layer:
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >d</span
                >
                <span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000"
                  >pgfgd_new_key</span
                >
                <span class="textcolor" style="color: #800080"
                  >("fast simple demo radius")</span
                >;<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >pgfgd_key_summary</span
                >
                <span class="textcolor" style="color: #800080"
                  >(d, "A radius value for the hello world of graph
                  drawing")</span
                >;<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >pgfgd_key_type</span
                >
                &numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #800080"
                  >(d, "length")</span
                >;<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >pgfgd_key_initial</span
                >
                <span class="textcolor" style="color: #800080">(d, "1cm")</span
                >;<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >pgfgd_declare</span
                >
                &numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #800080"
                  >(state, d)</span
                >;<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >pgfgd_free_key</span
                >
                &numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #800080"
                  >(d)</span
                >;<br />
                <br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >return</span
                >
                <span class="textcolor" style="color: #000000">0</span>;<br />
                }<br />
              </code>
            </div>
          </figure>

          <p>We simply add this code to the startup function above.</p>

          <p>
            Now it is time to compile and link the code. For this, you must,
            well, compile it, link it against the library
            <span class="texttt">InterfaceFromC</span>, and build a shared
            library out of it. Also, you must place it somewhere where Lua<span
              class="latexlogofont"
              ><span class="latexlogo"
                >T<span class="latexlogosub">e</span>X</span
              ></span
            >
            will find it. You will find a Makefile that should be able to
            achieve all of this in the directory
            <span class="texttt">pgf/c/graphdrawing/pgf/gd/examples/c</span>,
            where you will also find the code of the above example.
          </p>

          <p>
            Now, all you need to do to use it is to write in Lua (after you have
            loaded the <span class="texttt">pgf.gd</span> library, of course),
            would normally be the call
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000">require</span>
                <span class="textcolor" style="color: #000000">'pgf</span>.<span
                  class="textcolor"
                  style="color: #000000"
                  >gd</span
                >.<span class="textcolor" style="color: #000000"
                  ><a href="gd-algorithm-layer#pgf.examples">examples</a></span
                >.<span class="textcolor" style="color: #000000">c</span>.<span
                  class="textcolor"
                  style="color: #000000"
                  >SimpleDemoC'</span
                ><br />
              </code>
            </div>
          </figure>

          <p>or in <span class="tikzname">TikZ</span></p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #0000b2"
                  ><a href="gd-usage-tikz#pgf.back/usegdlibrary"
                    >\usegdlibrary</a
                  ></span
                >&numsp;{<span class="textcolor" style="color: #000000"
                  ><a href="gd-algorithm-layer#pgf.examples">examples</a></span
                >.<span class="textcolor" style="color: #000000">c</span>.<span
                  class="textcolor"
                  style="color: #000000"
                  >SimpleDemoC</span
                >}<br />
              </code>
            </div>
          </figure>

          <p>
            This should cause Lua<span class="latexlogofont"
              ><span class="latexlogo"
                >T<span class="latexlogosub">e</span>X</span
              ></span
            >
            to find the shared library, load it, and then call the function in
            that library with the lengthy name (the name is always
            <span class="texttt">luaopen_</span> followed by the path and
            filename with slashes replaced by underscores).
          </p>

          <p>
            <em>Remark:</em> Unfortunately, the above does not work with the
            <span class="latexlogofont"
              ><span class="latexlogo"
                >T<span class="latexlogosub">e</span>X</span
              ></span
            >Live 2013 versions of Lua<span class="latexlogofont"
              ><span class="latexlogo"
                >T<span class="latexlogosub">e</span>X</span
              ></span
            >
            due to a bugs that causes the &ldquo;replace dots by slashes&rdquo;
            to fail. For this reason, we currently need to rename our shared
            library file to
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000"
                  >pgf_gd_examples_c_SimpleDemoC</span
                >.<span class="textcolor" style="color: #000000">so</span><br />
              </code>
            </div>
          </figure>

          <p>and then say</p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000">require</span>
                <span class="textcolor" style="color: #000000"
                  >'pgf_gd_examples_c_SimpleDemoC'</span
                ><br />
              </code>
            </div>
          </figure>

          <p>or in <span class="tikzname">TikZ</span></p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #0000b2"
                  ><a href="gd-usage-tikz#pgf.back/usegdlibrary"
                    >\usegdlibrary</a
                  ></span
                >&numsp;{<span class="textcolor" style="color: #000000"
                  >pgf_gd_examples_c_SimpleDemoC</span
                >}<br />
              </code>
            </div>
          </figure>

          <p>
            In future versions of Lua<span class="latexlogofont"
              ><span class="latexlogo"
                >T<span class="latexlogosub">e</span>X</span
              ></span
            >, things should be &ldquo;back to normal&rdquo; in this regard.
            Also, the bug only concerns shared libraries; you can still create a
            normal Lua file with a nice name and place at a nice location and
            the only contents of this file is then the above
            <span class="texttt">require</span> command.
          </p>

          <p>Anyway, once we have loaded the shared library we can say:</p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #0000b2"
                  ><a href="tikz-scopes#pgf.back/tikz">\tikz</a></span
                >&numsp;<span class="textcolor" style="color: #0000b2"
                  ><a href="tikz-graphs#pgf.back/graph">\graph</a></span
                >&numsp;[<span class="textcolor" style="color: #008000"
                  >fast simple demo layout</span
                >,&numsp;<span class="textcolor" style="color: #008000"
                  >fast simple demo radius</span
                >=<span class="textcolor" style="color: #008000">1.25cm</span
                >]<br />
                {&numsp;<span class="textcolor" style="color: #000000">a</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">b</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">c</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">d</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">e</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">a</span> };<br />
              </code>
            </div>
          </figure>
          <h6 id="autosec-4860">
            <a id="section-gd-documenting-c-algos"></a
            ><span class="sectionnumber" id="sec-37.2.2">37.2.2&emsp;</span
            >Documenting Algorithms Written in C<a
              class="anchor-link"
              href="#sec-37.2.2"
              >&para;</a
            >
          </h6>
          <a id="pgfmanual-autopage-4860"></a>

          <p>
            In our above example, we included a summary with the keys in the C
            code. It would be even better if we added a longer documentation and
            some examples that show how the key works; but this is a bit
            impracticable in C since multi-line strings are hard to write down
            in&nbsp;C. The trick is to use the
            <span class="texttt">documentation_in</span> field of a key: It
            allows us to specify the name of a Lua file that should be loaded
            (using <span class="texttt">require</span>) to install the missing
            documentation fields. As explained in Section&nbsp;<a
              href="gd-algorithm-layer#section-gd-documentation-in"
              >36.2.7</a
            >, this Lua file may make good use the
            <span class="texttt">pgf.gd.doc</span> package. Note, also, that for
            keys documented in this way the documentation can easily be included
            in this manual through the use of the
            <span class="texttt">\includedocumentationof</span> command.
          </p>

          <p>
            In our example, we would first add the following line twice in the C
            code (once for each key), assuming that the documentation resides in
            the file
            <span class="texttt">pgf/gd/doc/examples/SimpleDemoC.lua</span>:
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >pgfgd_key_documentation_in</span
                >
                <span class="textcolor" style="color: #800080"
                  >(d, "pgf.gd.doc.examples.SimpleDemoC")</span
                >;<br />
              </code>
            </div>
          </figure>

          <p>
            Note that since the documentation is a normal Lua file, it will be
            searched in the usual places Lua files are located (in the texmf
            trees) and not, like the C shared library, in the special
            <span class="texttt">lib</span> subdirectory of the Lua<span
              class="latexlogofont"
              ><span class="latexlogo"
                >T<span class="latexlogosub">e</span>X</span
              ></span
            >
            binary.
          </p>

          <p>Here are typical contents of the documentation file:</p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.--">--</a></span
                >
                <span class="textcolor" style="color: #000000">File</span>
                <span class="textcolor" style="color: #000000"
                  >pgf/gd/doc/examples/SimpleDemoC</span
                >.<span class="textcolor" style="color: #000000">lua</span
                ><br />
                <span class="textcolor" style="color: #000000">local</span>
                <span class="textcolor" style="color: #000000">key</span>
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >=</span
                >
                <span class="textcolor" style="color: #000000">require</span>
                <span class="textcolor" style="color: #000000">'pgf</span>.<span
                  class="textcolor"
                  style="color: #000000"
                  >gd</span
                >.<span class="textcolor" style="color: #000000">doc'</span
                >.<span class="textcolor" style="color: #000000">key</span
                ><br />
                <span class="textcolor" style="color: #000000">local</span>
                <span class="textcolor" style="color: #000000"
                  >documentation</span
                >
                <span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000">require</span>
                <span class="textcolor" style="color: #000000">'pgf</span>.<span
                  class="textcolor"
                  style="color: #000000"
                  >gd</span
                >.<span class="textcolor" style="color: #000000">doc'</span
                >.<span class="textcolor" style="color: #000000"
                  >documentation</span
                ><br />
                <span class="textcolor" style="color: #000000">local</span>
                <span class="textcolor" style="color: #000000">summary</span>
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >=</span
                >
                <span class="textcolor" style="color: #000000">require</span>
                <span class="textcolor" style="color: #000000">'pgf</span>.<span
                  class="textcolor"
                  style="color: #000000"
                  >gd</span
                >.<span class="textcolor" style="color: #000000">doc'</span
                >.<span class="textcolor" style="color: #000000">summary</span
                ><br />
                <span class="textcolor" style="color: #000000">local</span>
                <span class="textcolor" style="color: #000000">example</span>
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >=</span
                >
                <span class="textcolor" style="color: #000000">require</span>
                <span class="textcolor" style="color: #000000">'pgf</span>.<span
                  class="textcolor"
                  style="color: #000000"
                  >gd</span
                >.<span class="textcolor" style="color: #000000">doc'</span
                >.<span class="textcolor" style="color: #000000">example</span
                ><br />
                <br />
                <span class="textcolor" style="color: #000000">key</span>
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >"fast</span
                >
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.simple">simple</a></span
                >
                <span class="textcolor" style="color: #000000">demo</span>
                <span class="textcolor" style="color: #000000">layout"</span
                ><br />
                <span class="textcolor" style="color: #000000"
                  >documentation</span
                ><br />
                [<span class="textcolor" style="color: #008000">[</span><br />
                <br />
                <span class="textcolor" style="color: #008000"
                  >This layout is used...</span
                ><br />
                <br />
                ]<span class="textcolor" style="color: #000000">]</span><br />
                <span class="textcolor" style="color: #000000">example</span
                ><br />
                [<span class="textcolor" style="color: #008000">[</span><br />
                <br />
                <span class="textcolor" style="color: #0000b2"
                  ><a href="tikz-scopes#pgf.back/tikz">\tikz</a></span
                >&numsp;<span class="textcolor" style="color: #0000b2"
                  ><a href="tikz-graphs#pgf.back/graph">\graph</a></span
                >&numsp;<span class="textcolor" style="color: #008000"
                  >[fast simple example layout</span
                >]<br />
                {&numsp;<span class="textcolor" style="color: #000000">a</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.--">--</a></span
                >
                <span class="textcolor" style="color: #000000">b</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.--">--</a></span
                >
                <span class="textcolor" style="color: #000000">c</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.--">--</a></span
                >
                <span class="textcolor" style="color: #000000">d</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.--">--</a></span
                >
                <span class="textcolor" style="color: #000000">e</span
                >;&numsp;};<br />
                <span class="textcolor" style="color: #000000">]]</span><br />
                <br />
                <span class="textcolor" style="color: #000000">key</span>
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >"fast</span
                >
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.simple">simple</a></span
                >
                <span class="textcolor" style="color: #000000">demo</span>
                <span class="textcolor" style="color: #000000">radius"</span
                ><br />
                <span class="textcolor" style="color: #000000"
                  >documentation</span
                ><br />
                [<span class="textcolor" style="color: #008000">[</span><br />
                <br />
                <span class="textcolor" style="color: #008000"
                  >The radius parameter is used to ...</span
                ><br />
                <br />
                ]<span class="textcolor" style="color: #000000">]</span><br />
                <span class="textcolor" style="color: #000000">example</span
                ><br />
                [<span class="textcolor" style="color: #008000">[</span><br />
                <br />
                <span class="textcolor" style="color: #0000b2"
                  ><a href="tikz-scopes#pgf.back/tikz">\tikz</a></span
                >&numsp;<span class="textcolor" style="color: #0000b2"
                  ><a href="tikz-graphs#pgf.back/graph">\graph</a></span
                >&numsp;<span class="textcolor" style="color: #008000"
                  >[fast simple demo layout</span
                >,&numsp;<span class="textcolor" style="color: #008000"
                  >fast simple demo radius</span
                >=<span class="textcolor" style="color: #008000">1.25cm</span
                >]<br />
                {&numsp;<span class="textcolor" style="color: #000000">a</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">b</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">c</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">d</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">e</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">a</span> };<br />
                <span class="textcolor" style="color: #000000">]]</span><br />
              </code>
            </div>
          </figure>
          <h6 id="autosec-4861">
            <span class="sectionnumber" id="sec-37.2.3">37.2.3&emsp;</span>The
            Interface From C<a class="anchor-link" href="#sec-37.2.3">&para;</a>
          </h6>
          <a id="pgfmanual-autopage-4861"></a>

          <p>
            In the above example, we already saw some of the functions from the
            library <span class="texttt">InterfaceFromC</span> that translated
            from Lua to C for us. For a complete list of all functions
            available, currently please see
            <span class="texttt"
              >graphdrawing/c/pgf/gd/interface/c/InterfaceFromC.h</span
            >
            directly.
          </p>

          <p>
            Currently, the library provides C functions to directly access all
            aspects of the syntactic digraph and also of the graphs computed by
            the preprocessing of the layout pipeline. What is missing, however,
            is access to the tree of (sub)layouts and to collections. Hopefully,
            these will be added in the future.
          </p>
          <h5 id="autosec-4862">
            <a id="section-gd-c++"></a
            ><span class="sectionnumber" id="sec-37.3">37.3&emsp;</span>Writing
            Graph Drawing Algorithms in C++<a
              class="anchor-link"
              href="#sec-37.3"
              >&para;</a
            >
          </h5>
          <a id="pgfmanual-autopage-4862"></a>

          <p>
            Built on top of the C interface presented in the previous section,
            there is also a C++ interface available. It encapsulates as much of
            the C functions as possible in C++ classes. Thus, this interface is
            mostly there for convenience, it does not offer fundamentally new
            functionality.
          </p>
          <h6 id="autosec-4863">
            <span class="sectionnumber" id="sec-37.3.1">37.3.1&emsp;</span>The
            Hello World of Graph Drawing in C++<a
              class="anchor-link"
              href="#sec-37.3.1"
              >&para;</a
            >
          </h6>
          <a id="pgfmanual-autopage-4863"></a>

          <p>
            Let us have a look at how our beloved hello world of graph drawing
            looks in C++. Although it is still possible to put graph drawing
            algorithms inside functions, it is more natural in C++ to turn them
            into methods of a class. Thus, we start the code of
            <span class="texttt">SimpleDemoCPlusPlus.c++</span> as follows:
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000">#include</span>
                <span class="textcolor" style="color: #000000"
                  ><pgf c gd interface interfacefromc++< span
                    >.<span class="textcolor" style="color: #000000">h&gt;</span
                    ><br />
                    <span class="textcolor" style="color: #000000"
                      >#include</span
                    >
                    <span class="textcolor" style="color: #000000"
                      ><pgf c gd interface interfacefromc< span
                        >.<span class="textcolor" style="color: #000000"
                          >h&gt;</span
                        ><br />
                        <br />
                        <span class="textcolor" style="color: #000000"
                          >#include</span
                        >
                        <span class="textcolor" style="color: #000000"
                          ><math< span
                            >.<span class="textcolor" style="color: #000000"
                              >h&gt;</span
                            ><br />
                            <br />
                            <span class="textcolor" style="color: #000000"
                              >struct</span
                            >
                            <span class="textcolor" style="color: #000000"
                              >FastLayout</span
                            >
                            <span class="textcolor" style="color: #000000"
                              ><a href="tikz-paths#pgf.:">:</a></span
                            >
                            <span class="textcolor" style="color: #000000"
                              >scripting::declarations</span
                            >,&numsp;<span
                              class="textcolor"
                              style="color: #000000"
                              >scripting::runner</span
                            >
                            {<br />
                            &numsp;&numsp;...<br />
                            }<br /> </math<></span></pgf></span></pgf></span
              ></code>
            </div>
          </figure>

          <p>
            As can be seen, we do not only include the interface from C++, but
            also that from C (since, currently, not all functionality of the C
            library is encapsulated in C++).
          </p>

          <p>
            The interesting part is the
            <span class="texttt">struct FastLayout</span>, which will contain
            our algorithm (you could just as well have used a
            <span class="texttt">class</span> instead of a
            <span class="texttt">struct</span>). It is derived from two classes:
            First, from a <span class="texttt">declarations</span> class and,
            secondly, from a <span class="texttt">runner</span> class. Both of
            them, just like everything else from the interface, reside in the
            namespace <span class="texttt">scripting</span>. This name was
            chosen since the main purpose of the interface is to provide
            &ldquo;scripting facilities&rdquo; to C code through the use of Lua.
          </p>

          <p>
            We are currently interested in the class
            <span class="texttt">runner</span>. This class has a virtual
            function <span class="texttt">run</span> that gets called when, on
            the Lua side, someone has selected the algorithm represented by the
            class. Thus, we place our algorithm in this method:
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000">void</span>
                <span class="textcolor" style="color: #000000">run</span>
                <span class="textcolor" style="color: #800080">()</span
                >&numsp;{<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >pgfgd_SyntacticDigraph*</span
                >
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.graph">graph</a></span
                >
                <span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000"
                  >parameters-&gt;syntactic_digraph</span
                >;<br />
                <br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  ><a href="tikz-actions#pgf.double">double</a></span
                >
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.angle">angle</a></span
                >
                &numsp;<span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000">6</span>.<span
                  class="textcolor"
                  style="color: #000000"
                  >28318530718</span
                >
                <span class="textcolor" style="color: #000000">/</span>
                <span class="textcolor" style="color: #000000"
                  >graph-&gt;vertices</span
                >.<span class="textcolor" style="color: #000000"
                  ><a href="tikz-arrows#pgf.length">length</a></span
                >;<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  ><a href="tikz-actions#pgf.double">double</a></span
                >
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.radius">radius</a></span
                >
                <span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000"
                  >parameters-&gt;option<double></double></span
                ><span class="textcolor" style="color: #800080"
                  >("fast simple demo radius c++")</span
                >;<br />
                <br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >for</span
                >
                <span class="textcolor" style="color: #800080"
                  >(int i = 0; i &lt; graph-&gt;vertices.length; i++)</span
                >&numsp;{<br />
                &numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >pgfgd_Vertex*</span
                >
                <span class="textcolor" style="color: #000000">v</span>
                <span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000"
                  >graph-&gt;vertices</span
                >.<span class="textcolor" style="color: #000000">array</span
                >[<span class="textcolor" style="color: #008000">i</span
                >];<br />
                &numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >v-&gt;pos</span
                >.<span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.x">x</a></span
                >
                <span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.cos">cos</a></span
                ><span class="textcolor" style="color: #800080">(angle*i)</span
                >&numsp;<span class="textcolor" style="color: #000000">*</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.radius">radius</a></span
                >;<br />
                &numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >v-&gt;pos</span
                >.<span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.y">y</a></span
                >
                <span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.sin">sin</a></span
                ><span class="textcolor" style="color: #800080">(angle*i)</span
                >&numsp;<span class="textcolor" style="color: #000000">*</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.radius">radius</a></span
                >;<br />
                &numsp;&numsp;}<br />
                }<br />
              </code>
            </div>
          </figure>

          <p>
            The <span class="texttt">run</span> method has access to the member
            variable <span class="texttt">parameters</span>, which contains all
            sorts of information concerning the to-be-drawn graph. In
            particular, the <span class="texttt">syntactic_digraph</span> field
            gives us access to the syntactic digraph structure that was already
            available in the interface from plain&nbsp;C. However, we can also
            see that a template function like
            <span class="texttt">option</span> allows us to access the
            graph&rsquo;s option table in a simple way.
          </p>

          <p>
            As for C code, our next task is to setup a key that, when used on
            the <span class="tikzname">TikZ</span> layer, will run our
            algorithm. For this, we can use an object derived from a
            <span class="texttt">declarations</span>. In our example, the
            <span class="texttt">FastLayout</span> is both derived from a
            <span class="texttt">runner</span> (since it contains an algorithm)
            and also from <span class="texttt">declarations</span> (since it
            also contains the code necessary for declaring this algorithm). If
            you prefer, you can split this into two classes. A
            <span class="texttt">declarations</span> object must override the
            <span class="texttt">declare</span> method. This method gets a
            <span class="texttt">script</span> object as input, which is the
            &ldquo;representation&rdquo; of Lua inside the C++ code:
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000">void</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.declare">declare</a></span
                ><span class="textcolor" style="color: #800080"
                  >(scripting::script s)</span
                >&numsp;{<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >using</span
                >
                <span class="textcolor" style="color: #000000">namespace</span>
                <span class="textcolor" style="color: #000000">scripting</span
                >;<br />
                <br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >s</span
                >.<span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.declare">declare</a></span
                ><span class="textcolor" style="color: #800080"
                  >(key ("fast simple demo layout c++")</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  >summary</span
                >
                <span class="textcolor" style="color: #800080"
                  >("The C++ version of the hello world of graph drawing")</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  >precondition</span
                >
                <span class="textcolor" style="color: #800080"
                  >("connected")</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  >precondition</span
                >
                <span class="textcolor" style="color: #800080">("tree")</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  >algorithm</span
                >
                <span class="textcolor" style="color: #800080">(this)</span
                >);<br />
                <br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >s</span
                >.<span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.declare">declare</a></span
                ><span class="textcolor" style="color: #800080"
                  >(key ("fast simple demo radius c++")</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  >summary</span
                >
                <span class="textcolor" style="color: #800080"
                  >("A radius value for the hello world of graph drawing")</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  ><a href="library-patterns#pgf.type">type</a></span
                >
                <span class="textcolor" style="color: #800080">("length")</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  ><a href="library-automata#pgf.initial">initial</a></span
                >
                <span class="textcolor" style="color: #800080">("1cm")</span
                >);<br />
                }<br />
              </code>
            </div>
          </figure>

          <p>
            For each key that we wish to declare, we call the script&rsquo;s
            <span class="texttt">declare</span> method once. This method takes a
            <span class="texttt">key</span> object as input, which can be
            configured through a sequence of calls to different member functions
            (like <span class="texttt">summary</span> or
            <span class="texttt">algorithm</span>). Most of these member
            functions are rather self-explaining; only
            <span class="texttt">algorithm</span> is a bit trickier: It does not
            take a function as input, but rather an object of type
            <span class="texttt">runner</span> and it will call the
            <span class="texttt">run</span> method of this object whenever the
            algorithm is run.
          </p>

          <p>Lastly, we also need to write the entry point:</p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000">extern</span>
                <span class="textcolor" style="color: #000000">"C"</span>
                <span class="textcolor" style="color: #000000">int</span>
                <span class="textcolor" style="color: #000000"
                  >luaopen_pgf_gd_examples_c_SimpleDemoCPlusPlus</span
                >
                <span class="textcolor" style="color: #800080"
                  >(struct lua_State *state)</span
                >&numsp;{<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >scripting::script</span
                >
                <span class="textcolor" style="color: #000000">s</span>
                <span class="textcolor" style="color: #800080">(state)</span
                >;<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >s</span
                >.<span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.declare">declare</a></span
                >
                <span class="textcolor" style="color: #800080"
                  >(new FastLayout)</span
                >;<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >return</span
                >
                <span class="textcolor" style="color: #000000">0</span>;<br />
                }<br />
              </code>
            </div>
          </figure>

          <p>
            Note that it is the job of the interface classes to free the passed
            <span class="texttt">declarations</span> object. For this reason,
            you really need to call <span class="texttt">new</span> and cannot
            pass the address of a temporary object.
          </p>

          <p>
            As before, because of the bug in some Lua<span class="latexlogofont"
              ><span class="latexlogo"
                >T<span class="latexlogosub">e</span>X</span
              ></span
            >
            versions, to actually load the library at runtime, we need to rename
            it to
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000"
                  >pgf_gd_examples_c_SimpleDemoCPlusPlus</span
                >.<span class="textcolor" style="color: #000000">so</span><br />
              </code>
            </div>
          </figure>

          <p>and then say</p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000">require</span>
                <span class="textcolor" style="color: #000000"
                  >'pgf_gd_examples_c_SimpleDemoCPlusPlus'</span
                ><br />
              </code>
            </div>
          </figure>

          <p>or in <span class="tikzname">TikZ</span></p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #0000b2"
                  ><a href="gd-usage-tikz#pgf.back/usegdlibrary"
                    >\usegdlibrary</a
                  ></span
                >&numsp;{<span class="textcolor" style="color: #000000"
                  >pgf_gd_examples_c_SimpleDemoCPlusPlus</span
                >}<br />
              </code>
            </div>
          </figure>

          <p>We can now use it:</p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #0000b2"
                  ><a href="tikz-scopes#pgf.back/tikz">\tikz</a></span
                >&numsp;<span class="textcolor" style="color: #0000b2"
                  ><a href="tikz-graphs#pgf.back/graph">\graph</a></span
                >&numsp;[<span class="textcolor" style="color: #008000"
                  >fast simple demo layout c++</span
                >,&numsp;<span class="textcolor" style="color: #008000"
                  >fast simple demo radius c++</span
                >=<span class="textcolor" style="color: #008000">1.25cm</span
                >]<br />
                {&numsp;<span class="textcolor" style="color: #000000">a</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">b</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">c</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">d</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">e</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">a</span> };<br />
              </code>
            </div>
          </figure>
          <h6 id="autosec-4864">
            <span class="sectionnumber" id="sec-37.3.2">37.3.2&emsp;</span>The
            Interface From C++<a class="anchor-link" href="#sec-37.3.2"
              >&para;</a
            >
          </h6>
          <a id="pgfmanual-autopage-4864"></a>

          <p>
            The header
            <span class="texttt"
              >graphdrawing/c/pgf/gd/interface/c/InterfaceFromC++.h</span
            >
            contains, as the name suggest, the interface from C++. A complete
            documentation is still missing, but let us go over the main ideas:
          </p>

          <p>
            <b>Runners.</b> Algorithms are represented by objects of type
            <span class="texttt">runner</span>. An algorithm will overwrite the
            <span class="texttt">run</span> method, as we saw in the example,
            and it should modify the <span class="texttt">parameters</span> of
            the runner object.
          </p>

          <p>
            In addition to the <span class="texttt">run</span> method, there are
            also two more virtual methods, called
            <span class="texttt">bridge</span> and
            <span class="texttt">unbrigde</span>. The first is called before the
            <span class="texttt">run</span> method is called and the second
            afterwards. The idea is that another framework, such as
            <span class="textsc">ogdf</span>, can implement a new class
            <span class="texttt">ogdf_runner</span> that overrides these two
            methods in order to transform the Lua/C representation of the input
            graph into an <span class="textsc">ogdf</span> representation prior
            to the <span class="texttt">run</span> method being called. The
            <span class="texttt">run</span> method can then access additional
            member variables that store the graph representations in
            <span class="textsc">ogdf</span> form (or another form, depending on
            the framework). The <span class="texttt">unbridge</span> method
            allows the framework to translate back.
          </p>

          <p>
            Although a <span class="texttt">runner</span> object must be created
            for every algorithm, an algorithm can also reside in a function. The
            class <span class="texttt">function_runner</span> is a simple
            wrapper that turns a function into such an object.
          </p>

          <p>
            <b>Keys.</b> A key object is a temporary object that is passed to
            the <span class="texttt">declare</span> method of a script. It
            represents the table that is passed to the Lua function
            <span class="texttt">declare</span>. In order to make setting its
            field easy, for each field name there is a corresponding function
            (like <span class="texttt">summary</span>) that takes the string
            that should be set to this field and returns the key object once
            more, so that we can chain calls.
          </p>

          <p>
            The <span class="texttt">algorithm</span> method gets a runner
            object as parameter and will store a pointer to this object inside
            Lua. Each time the algorithm is used, this object will be used to
            &ldquo;run&rdquo; the algorithm, that is, the methods
            <span class="texttt">prepare</span>,
            <span class="texttt">bridge</span>, <span class="texttt">run</span>,
            and <span class="texttt">unbridge</span> will be called in that
            order. Since the object is reused each time, only one object is
            needed; but this object may not be freed prematurely. Indeed, you
            will normally create the object using
            <span class="texttt">new</span> once and will then never delete it.
          </p>

          <p>A typical idiom you may find in the code is</p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000">s</span>.<span
                  class="textcolor"
                  style="color: #000000"
                  ><a href="tikz-graphs#pgf.declare">declare</a></span
                >
                <span class="textcolor" style="color: #800080">(key (...)</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  >algorithm</span
                ><span class="textcolor" style="color: #800080">(this)</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;...);<br />
              </code>
            </div>
          </figure>

          <p>
            This code is seen inside the
            <span class="texttt">declare</span> method of objects that are both
            declarations and runners. They register &ldquo;themselves&rdquo; via
            the above code. Note, however, that this requires that the
            <span class="texttt">this</span> pointer is not a temporary object.
            (The typing rules of C++ make it hard for this situation to happen,
            but it can be achieved.)
          </p>

          <p>
            <b>Reading options.</b> Once options have been declared, your C++
            algorithms will wish to read them back. For this, the
            <span class="texttt">parameters</span> field of a runner object
            provides a number of templated methods:
          </p>
          <ul style="list-style-type: none">
            <li>
              <p>
                &bull; The <span class="texttt">option_is_set</span> method
                returns <span class="texttt">true</span> if the passed option
                has been set <em>and</em> can be cast to the type of the
                template. So,
                <span class="texttt"
                  >option_is_set<double>("node distance")</double></span
                >
                will return true if the
                <span class="texttt">node distance</span> key has been set for
                the graph as a whole (currently, there is no way to read the
                options of a vertex or an edge from C++, use the C methods
                instead).
              </p>
            </li>
            <li>
              <p>
                &bull; The <span class="texttt">option</span> function comes in
                two flavours: First, it takes a single option name and just
                returns the option&rsquo;s value. If, however, the option has
                not been set or has another type, some sort of null value is
                returned. So,
                <span class="texttt"
                  >option<double>("node distance")</double></span
                >
                will return the configured node distance as a double. When an
                option has an initial value, this call will always return a
                sensible value.
              </p>
              <p>
                The second flavour of <span class="texttt">option</span> allows
                you to pass a reference to an object in which the option&rsquo;s
                value should be stored and the function will return true if the
                option is set (and, thus, something was written into the
                reference). This is the &ldquo;safest&rdquo; way to access an
                option:
              </p>

              <figure class="example">
                <div class="example-code">
                  <button class="clipboardButton" type="button">copy</button>
                  <code
                    ><br />
                    <span class="textcolor" style="color: #000000"
                      ><a href="tikz-actions#pgf.double"> double</a></span
                    >
                    <span class="textcolor" style="color: #000000">dist</span
                    >;<br />
                    <span class="textcolor" style="color: #000000"
                      ><a href="library-calender#pgf.if"> if</a></span
                    >
                    <span class="textcolor" style="color: #800080"
                      >(parameters-&gt;option ("node distance", dist)</span
                    >)<br />
                    &numsp;&numsp;...<br />
                  </code>
                </div>
              </figure>
              <p>
                Caution must be taken for
                <span class="texttt">char*</span> options: The returned string
                must be explicitly freed; it will be a copy of the string stored
                in the Lua table.
              </p>
            </li>
            <li>
              <p>
                &bull; The <span class="texttt">configure_option</span> method
                is used to set a member of an object based on the value of a
                certain option. For this, you must pass a pointer to a member
                function that sets the member. Here is an example:
              </p>

              <figure class="example">
                <div class="example-code">
                  <button class="clipboardButton" type="button">copy</button>
                  <code
                    ><br />
                    <span class="textcolor" style="color: #000000"
                      ><a href="drivers#pgf.class"> class</a></span
                    >
                    <span class="textcolor" style="color: #000000"
                      >MyClass</span
                    >
                    {<br />
                    <span class="textcolor" style="color: #000000">public:</span
                    ><br />
                    &numsp;&numsp;<span class="textcolor" style="color: #000000"
                      >void</span
                    >
                    <span class="textcolor" style="color: #000000"
                      >setMyDistance</span
                    >
                    <span class="textcolor" style="color: #800080"
                      >(double distance)</span
                    >;<br />
                    ...<br />
                    };<br />
                    ...<br />
                    <br />
                    <span class="textcolor" style="color: #000000"
                      >MyClass</span
                    >
                    <span class="textcolor" style="color: #000000"
                      ><a href="tikz-graphs#pgf.m"> m</a></span
                    >;<br />
                    <span class="textcolor" style="color: #000000"
                      >parameters-&gt;configure_option</span
                    ><span class="textcolor" style="color: #800080"
                      >("node distance", &amp;MyClass::setMyDistance, m)</span
                    >;<br />
                  </code>
                </div>
              </figure>
              <p>
                If the option has not been set or does not have the correct
                type, the member function is not called.
              </p>
            </li>
          </ul>

          <p>
            <b>Factories and modules.</b> A Lua key is normally either a
            Boolean, a double, or a string. However, in C++, we may also
            sometimes wish Lua users to configure which C function is used to
            achieve something. One could do this using strings or numbers and
            then use search algorithms or a long
            <span class="texttt">switch</span>, but this would neither be
            flexible nor elegant.
          </p>

          <p>
            Instead, it is possible to store <em>factories</em> in Lua keys. A
            factory is a class derived from
            <span class="texttt">factory</span> that implements the virtual
            function <span class="texttt">make</span>. This function will return
            a new object of a template type. You can store such a factory in a
            key.
          </p>

          <p>
            The <span class="texttt">make</span> method of a parameters object
            allows you to invoke the factory stored in a key. (If no factory is
            stored in it, <span class="texttt">null</span> is returned).
          </p>

          <p>
            The <span class="texttt">configure_module</span> method is akin to
            <span class="texttt">configure_option</span>, only the result of
            applying the factory is passed to the member function of the class.
          </p>

          <p>
            <b>Scripts.</b> A &ldquo;script&rdquo; is the abstraction of the
            communication between Lua and C++. From C++&rsquo;s point of view,
            the script object offers different
            <span class="texttt">declare</span> methods that allow us to
            &ldquo;make objects and function scriptable&rdquo; in the sense that
            they can then be called and configured from Lua. The script must be
            initialized with a Lua state and will be bound to that state
            (basically, the script only stores this single pointer).
          </p>

          <p>
            When you call <span class="texttt">declare</span>, you either pass a
            single key object (which is then declared on the Lua layer) or you
            pass a <span class="texttt">declarations</span> object, whose
            virtual <span class="texttt">declare</span> method is then called.
            The <span class="texttt">declarations</span> objects are used to
            bundle several declarations into a single one.
          </p>
          <h5 id="autosec-4865">
            <a id="section-gd-ogdf-interface"></a
            ><span class="sectionnumber" id="sec-37.4">37.4&emsp;</span>Writing
            Graph Drawing Algorithms Using OGDF<a
              class="anchor-link"
              href="#sec-37.4"
              >&para;</a
            >
          </h5>
          <a id="pgfmanual-autopage-4865"></a>

          <p>
            Built on top of the C++ interface, a small interface allows you to
            easily link algorithms written for the
            <span class="textsc">ogdf</span> (Open Graph Drawing Framework) with
            graph drawing in Lua.
          </p>
          <h6 id="autosec-4866">
            <span class="sectionnumber" id="sec-37.4.1">37.4.1&emsp;</span>The
            Hello World of Graph Drawing in OGDF &ndash; From Scratch<a
              class="anchor-link"
              href="#sec-37.4.1"
              >&para;</a
            >
          </h6>
          <a id="pgfmanual-autopage-4866"></a>

          <p>We start with some startup code:</p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000">#include</span>
                <span class="textcolor" style="color: #000000"
                  ><pgf c gd interfacefromogdf< ogdf span
                    >.<span class="textcolor" style="color: #000000">h&gt;</span
                    ><br />
                    <span class="textcolor" style="color: #000000"
                      >#include</span
                    >
                    <span class="textcolor" style="color: #000000"
                      ><math< span
                        >.<span class="textcolor" style="color: #000000"
                          >h&gt;</span
                        ><br />
                        <br />
                        <span class="textcolor" style="color: #000000"
                          >using</span
                        >
                        <span class="textcolor" style="color: #000000"
                          >namespace</span
                        >
                        <span class="textcolor" style="color: #000000"
                          >ogdf</span
                        >;<br />
                        <span class="textcolor" style="color: #000000"
                          >using</span
                        >
                        <span class="textcolor" style="color: #000000"
                          >namespace</span
                        >
                        <span class="textcolor" style="color: #000000"
                          >scripting</span
                        >;<br /> </math<></span></pgf></span
              ></code>
            </div>
          </figure>

          <p>
            Note that the interface from
            <span class="textsc">ogdf</span> resides in the
            <span class="texttt">ogdf</span> folder, not in the
            <span class="texttt">interface</span> folder.
          </p>

          <p>
            Like in the plain C++ interface, we must now subclass the
            <span class="texttt">runner</span> class and the
            <span class="texttt">declarations</span> class. Also like the plain
            C++ interface, we can use multiple inheritance. The difference lies
            in the fact that we do not directly subclass form
            <span class="texttt">runner</span>, but rather from
            <span class="texttt">ogdf_runner</span>. This class implements the
            complicated &ldquo;bridging&rdquo; or &ldquo;translation&rdquo;
            process between the world of
            <span class="texttt">InterfaceFromC++</span> and
            <span class="textsc">ogdf</span>:
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000">struct</span>
                <span class="textcolor" style="color: #000000"
                  >FastLayoutOGDF</span
                >
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.:">:</a></span
                >
                <span class="textcolor" style="color: #000000"
                  >declarations</span
                >,&numsp;<span class="textcolor" style="color: #000000"
                  >ogdf_runner</span
                >
                {<br />
                <br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >void</span
                >
                <span class="textcolor" style="color: #000000">run</span>
                <span class="textcolor" style="color: #800080">()</span
                >&numsp;{<br />
                &numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  ><a href="tikz-actions#pgf.double">double</a></span
                >
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.angle">angle</a></span
                >
                &numsp;<span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000">6</span>.<span
                  class="textcolor"
                  style="color: #000000"
                  >28318530718</span
                >
                <span class="textcolor" style="color: #000000">/</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.graph">graph</a></span
                >.<span class="textcolor" style="color: #000000"
                  >numberOfNodes</span
                ><span class="textcolor" style="color: #800080">()</span>;<br />
                &numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  ><a href="tikz-actions#pgf.double">double</a></span
                >
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.radius">radius</a></span
                >
                <span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000"
                  >parameters-&gt;option<double></double></span
                ><span class="textcolor" style="color: #800080"
                  >("my radius ogdf")</span
                >;<br />
                <br />
                &numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >int</span
                >
                <span class="textcolor" style="color: #000000">i</span>
                <span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000">0</span>;<br />
                &numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >for</span
                >
                <span class="textcolor" style="color: #800080"
                  >(node v = graph.firstNode()</span
                >;&numsp;<span class="textcolor" style="color: #000000">v</span
                >;&numsp;<span class="textcolor" style="color: #000000"
                  >v=v-&gt;succ</span
                ><span class="textcolor" style="color: #800080">()</span
                >,&numsp;<span class="textcolor" style="color: #000000"
                  >i++</span
                >)&numsp;{<br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >graph_attributes</span
                >.<span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.x">x</a></span
                ><span class="textcolor" style="color: #800080">(v)</span
                >&numsp;<span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.cos">cos</a></span
                ><span class="textcolor" style="color: #800080">(angle*i)</span
                >&numsp;<span class="textcolor" style="color: #000000">*</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.radius">radius</a></span
                >;<br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >graph_attributes</span
                >.<span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.y">y</a></span
                ><span class="textcolor" style="color: #800080">(v)</span
                >&numsp;<span class="textcolor" style="color: #000000">=</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.sin">sin</a></span
                ><span class="textcolor" style="color: #800080">(angle*i)</span
                >&numsp;<span class="textcolor" style="color: #000000">*</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-coordinates#pgf.radius">radius</a></span
                >;<br />
                &numsp;&numsp;&numsp;&numsp;}<br />
                &numsp;&numsp;}<br />
              </code>
            </div>
          </figure>

          <p>
            As can be seen, in a subclass of
            <span class="texttt">ogdf_runner</span>, the
            <span class="texttt">run</span> method will have access to a member
            called <span class="texttt">graph</span> and to another member
            called <span class="texttt">graph_attributes</span>. These will have
            been setup with the graph from the Lua layer and, after the
            algorithm has run, the information stored in the
            <span class="texttt">x</span> and
            <span class="texttt">y</span> fields of the graph attributes and
            also the bend information of the edges will be written back
            automatically.
          </p>

          <p>
            Next, we need to declare the algorithm. This is done as in the plain
            C++ interface:
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >void</span
                >
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.declare">declare</a></span
                ><span class="textcolor" style="color: #800080">(script s)</span
                >&numsp;{<br />
                &numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >using</span
                >
                <span class="textcolor" style="color: #000000">namespace</span>
                <span class="textcolor" style="color: #000000">scripting</span
                >;<br />
                <br />
                &numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >s</span
                >.<span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.declare">declare</a></span
                ><span class="textcolor" style="color: #800080"
                  >(key ("fast simple demo layout ogdf")</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  >summary</span
                >
                <span class="textcolor" style="color: #800080"
                  >("The OGDF version of the hello world of graph
                  drawing")</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  >precondition</span
                >
                <span class="textcolor" style="color: #800080"
                  >("connected")</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  >algorithm</span
                >
                <span class="textcolor" style="color: #800080">(this)</span
                >);<br />
                <br />
                &numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  >s</span
                >.<span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.declare">declare</a></span
                ><span class="textcolor" style="color: #800080"
                  >(key ("my radius ogdf")</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  >summary</span
                >
                <span class="textcolor" style="color: #800080"
                  >("A radius value for the hello world of graph drawing")</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  ><a href="library-patterns#pgf.type">type</a></span
                >
                <span class="textcolor" style="color: #800080">("length")</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  ><a href="library-automata#pgf.initial">initial</a></span
                >
                <span class="textcolor" style="color: #800080">("1cm")</span
                >);<br />
                &numsp;&numsp;}<br />
                };<br />
              </code>
            </div>
          </figure>

          <p>
            Finally, we need the entry point, which is also &ldquo;as
            usual&rdquo;:
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000">extern</span>
                <span class="textcolor" style="color: #000000">"C"</span>
                <span class="textcolor" style="color: #000000">int</span>
                <span class="textcolor" style="color: #000000"
                  >luaopen_pgf_gd_examples_c_SimpleDemoOGDF</span
                >
                <span class="textcolor" style="color: #800080"
                  >(struct lua_State *state)</span
                >&numsp;{<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >script</span
                >
                <span class="textcolor" style="color: #800080">(state)</span
                >.<span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.declare">declare</a></span
                >
                <span class="textcolor" style="color: #800080"
                  >(new FastLayoutOGDF)</span
                >;<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >return</span
                >
                <span class="textcolor" style="color: #000000">0</span>;<br />
                }<br />
              </code>
            </div>
          </figure>

          <p>
            Yet again, we need to rename the resulting shared library and then
            say <span class="texttt">require</span> on it. We can now use it:
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #0000b2"
                  ><a href="tikz-scopes#pgf.back/tikz">\tikz</a></span
                >&numsp;<span class="textcolor" style="color: #0000b2"
                  ><a href="tikz-graphs#pgf.back/graph">\graph</a></span
                >&numsp;[<span class="textcolor" style="color: #008000"
                  >fast simple demo layout ogdf</span
                >,&numsp;<span class="textcolor" style="color: #008000"
                  >my radius ogdf</span
                >=<span class="textcolor" style="color: #008000">1cm</span
                >]<br />
                {&numsp;<span class="textcolor" style="color: #000000">a</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">b</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">c</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">d</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">e</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.-&gt;">-&gt;</a></span
                >
                <span class="textcolor" style="color: #000000">a</span> };<br />
              </code>
            </div>
          </figure>
          <h6 id="autosec-4867">
            <span class="sectionnumber" id="sec-37.4.2">37.4.2&emsp;</span>The
            Hello World of Graph Drawing in OGDF &ndash; Adapting Existing
            Classes<a class="anchor-link" href="#sec-37.4.2">&para;</a>
          </h6>
          <a id="pgfmanual-autopage-4867"></a>

          <p>
            In the previous example we implemented a graph drawing algorithm
            using <span class="textsc">ogdf</span> for use with Lua &ldquo;from
            scratch&rdquo;. In particular, the whole algorithm was contained in
            the <span class="texttt">run</span> method of our main class. In
            practice, however, graph drawing algorithms are typically placed in
            classes that &ldquo;know nothing about scripting&rdquo;. For
            instance, our hello world of graph drawing might actually be
            implemented like this:
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000">//</span>
                <span class="textcolor" style="color: #000000">File</span>
                <span class="textcolor" style="color: #000000"
                  >HelloWorldLayout</span
                >.<span class="textcolor" style="color: #000000">h</span><br />
                <span class="textcolor" style="color: #000000">#include</span>
                <span class="textcolor" style="color: #000000"
                  ><ogdf layoutmodule< module span
                    >.<span class="textcolor" style="color: #000000">h&gt;</span
                    ><br />
                    <br />
                    <span class="textcolor" style="color: #000000"
                      ><a href="drivers#pgf.class">class</a></span
                    >
                    <span class="textcolor" style="color: #000000"
                      >HelloWorldLayout</span
                    >
                    <span class="textcolor" style="color: #000000"
                      ><a href="tikz-paths#pgf.:">:</a></span
                    >
                    <span class="textcolor" style="color: #000000">puplic</span>
                    <span class="textcolor" style="color: #000000"
                      >ogdf::LayoutModule</span
                    >
                    {<br />
                    <span class="textcolor" style="color: #000000">public:</span
                    ><br />
                    <br />
                    &numsp;&numsp;<span class="textcolor" style="color: #000000"
                      >virtual</span
                    >
                    <span class="textcolor" style="color: #000000">void</span>
                    <span class="textcolor" style="color: #000000">call</span
                    ><span class="textcolor" style="color: #800080"
                      >(ogdf::GraphAttributes &amp;GA)</span
                    ><br />
                    &numsp;&numsp;{<br />
                    &numsp;&numsp;&numsp;&numsp;<span
                      class="textcolor"
                      style="color: #000000"
                      >using</span
                    >
                    <span class="textcolor" style="color: #000000"
                      >namespace</span
                    >
                    <span class="textcolor" style="color: #000000">ogdf</span
                    >;<br />
                    <br />
                    &numsp;&numsp;&numsp;&numsp;<span
                      class="textcolor"
                      style="color: #000000"
                      >const</span
                    >
                    <span class="textcolor" style="color: #000000">Graph</span>
                    <span class="textcolor" style="color: #000000"
                      >&amp;graph</span
                    >
                    <span class="textcolor" style="color: #000000">=</span>
                    <span class="textcolor" style="color: #000000">GA</span
                    >.<span class="textcolor" style="color: #000000"
                      >constGraph</span
                    ><span class="textcolor" style="color: #800080">()</span
                    >;<br />
                    &numsp;&numsp;&numsp;&numsp;<span
                      class="textcolor"
                      style="color: #000000"
                      ><a href="tikz-actions#pgf.double">double</a></span
                    >
                    <span class="textcolor" style="color: #000000"
                      ><a href="tikz-coordinates#pgf.angle">angle</a></span
                    >
                    &numsp;<span class="textcolor" style="color: #000000"
                      >=</span
                    >
                    <span class="textcolor" style="color: #000000">6</span
                    >.<span class="textcolor" style="color: #000000"
                      >28318530718</span
                    >
                    <span class="textcolor" style="color: #000000">/</span>
                    <span class="textcolor" style="color: #000000"
                      ><a href="tikz-graphs#pgf.graph">graph</a></span
                    >.<span class="textcolor" style="color: #000000"
                      >numberOfNodes</span
                    ><span class="textcolor" style="color: #800080">()</span
                    >;<br />
                    &numsp;&numsp;&numsp;&numsp;<span
                      class="textcolor"
                      style="color: #000000"
                      >int</span
                    >
                    <span class="textcolor" style="color: #000000">i</span>
                    <span class="textcolor" style="color: #000000">=</span>
                    <span class="textcolor" style="color: #000000">0</span
                    >;<br />
                    &numsp;&numsp;&numsp;&numsp;<span
                      class="textcolor"
                      style="color: #000000"
                      >for</span
                    >
                    <span class="textcolor" style="color: #800080"
                      >(node v = graph.firstNode()</span
                    >;&numsp;<span class="textcolor" style="color: #000000"
                      >v</span
                    >;&numsp;<span class="textcolor" style="color: #000000"
                      >v=v-&gt;succ</span
                    ><span class="textcolor" style="color: #800080">()</span
                    >,&numsp;<span class="textcolor" style="color: #000000"
                      >i++</span
                    >)&numsp;{<br />
                    &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                      class="textcolor"
                      style="color: #000000"
                      >GA</span
                    >.<span class="textcolor" style="color: #000000"
                      ><a href="tikz-coordinates#pgf.x">x</a></span
                    ><span class="textcolor" style="color: #800080">(v)</span
                    >&numsp;<span class="textcolor" style="color: #000000"
                      >=</span
                    >
                    <span class="textcolor" style="color: #000000"
                      ><a href="tikz-paths#pgf.cos">cos</a></span
                    ><span class="textcolor" style="color: #800080"
                      >(angle*i)</span
                    >&numsp;<span class="textcolor" style="color: #000000"
                      >*</span
                    >
                    <span class="textcolor" style="color: #000000"
                      ><a href="tikz-coordinates#pgf.radius">radius</a></span
                    >;<br />
                    &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                      class="textcolor"
                      style="color: #000000"
                      >GA</span
                    >.<span class="textcolor" style="color: #000000"
                      ><a href="tikz-coordinates#pgf.y">y</a></span
                    ><span class="textcolor" style="color: #800080">(v)</span
                    >&numsp;<span class="textcolor" style="color: #000000"
                      >=</span
                    >
                    <span class="textcolor" style="color: #000000"
                      ><a href="tikz-paths#pgf.sin">sin</a></span
                    ><span class="textcolor" style="color: #800080"
                      >(angle*i)</span
                    >&numsp;<span class="textcolor" style="color: #000000"
                      >*</span
                    >
                    <span class="textcolor" style="color: #000000"
                      ><a href="tikz-coordinates#pgf.radius">radius</a></span
                    >;<br />
                    &numsp;&numsp;&numsp;&numsp;}<br />
                    &numsp;&numsp;}<br />
                    <br />
                    &numsp;&numsp;<span class="textcolor" style="color: #000000"
                      >void</span
                    >
                    <span class="textcolor" style="color: #000000"
                      >setRadius</span
                    >
                    <span class="textcolor" style="color: #800080"
                      >(double r)</span
                    >&numsp;{&numsp;<span
                      class="textcolor"
                      style="color: #000000"
                      ><a href="tikz-coordinates#pgf.radius">radius</a></span
                    >
                    <span class="textcolor" style="color: #000000">=</span>
                    <span class="textcolor" style="color: #000000"
                      ><a href="library-perspective#pgf.r">r</a></span
                    >;&numsp;}<br />
                    <br />
                    <span class="textcolor" style="color: #000000"
                      >private:</span
                    ><br />
                    <br />
                    &numsp;&numsp;<span class="textcolor" style="color: #000000"
                      ><a href="tikz-actions#pgf.double">double</a></span
                    >
                    <span class="textcolor" style="color: #000000"
                      ><a href="tikz-coordinates#pgf.radius">radius</a></span
                    >;<br />
                    };<br /> </ogdf></span
              ></code>
            </div>
          </figure>

          <p>
            Now, what we actually want to do is to &ldquo;make this class
            scriptable&rdquo;. For this, we setup a new class whose
            <span class="texttt">run</span> method will produce a new
            <span class="texttt">HelloWorldLayout</span>, configure it, and then
            run it. Here is this run method:
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000">void</span>
                <span class="textcolor" style="color: #000000">run</span>
                <span class="textcolor" style="color: #800080">()</span><br />
                {<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >HelloWorldLayout</span
                >
                <span class="textcolor" style="color: #000000">layout</span
                >;<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >parameters-&gt;configure_option</span
                ><span class="textcolor" style="color: #800080"
                  >("HelloWorldLayout.radius", &amp;HelloWorldLayout::setRadius,
                  layout)</span
                >;<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >layout</span
                >.<span class="textcolor" style="color: #000000">call</span
                ><span class="textcolor" style="color: #800080"
                  >(graph_attributes)</span
                >;<br />
                }<br />
              </code>
            </div>
          </figure>

          <p>
            Next, we need to write the declarations code. This is very similar
            to the &ldquo;from scratch&rdquo; version:
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000">void</span>
                <span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.declare">declare</a></span
                ><span class="textcolor" style="color: #800080">(script s)</span
                >&numsp;{<br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >using</span
                >
                <span class="textcolor" style="color: #000000">namespace</span>
                <span class="textcolor" style="color: #000000">scripting</span
                >;<br />
                <br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >s</span
                >.<span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.declare">declare</a></span
                ><span class="textcolor" style="color: #800080"
                  >(key ("HelloWorldLayout")</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  >summary</span
                >
                <span class="textcolor" style="color: #800080"
                  >("The OGDF version of the hello world of graph
                  drawing")</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  >precondition</span
                >
                <span class="textcolor" style="color: #800080"
                  >("connected")</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  >algorithm</span
                >
                <span class="textcolor" style="color: #800080">(this)</span
                >);<br />
                <br />
                &numsp;&numsp;<span class="textcolor" style="color: #000000"
                  >s</span
                >.<span class="textcolor" style="color: #000000"
                  ><a href="tikz-graphs#pgf.declare">declare</a></span
                ><span class="textcolor" style="color: #800080"
                  >(key ("HelloWorldLayout.radius")</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  >summary</span
                >
                <span class="textcolor" style="color: #800080"
                  >("A radius value for the hello world of graph drawing")</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  ><a href="library-patterns#pgf.type">type</a></span
                >
                <span class="textcolor" style="color: #800080">("length")</span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;.<span
                  class="textcolor"
                  style="color: #000000"
                  ><a href="tikz-shapes#pgf.alias">alias</a></span
                >
                <span class="textcolor" style="color: #800080">("radius")</span
                >);<br />
                }<br />
              </code>
            </div>
          </figure>

          <p>
            Two remarks are in order: First, it is customary to name the keys
            for the display system the same way as the classes. Second, the
            different configuration options of the algorithm are named with the
            class name followed by the option name. This makes it clear who,
            exactly, is being configured. However, these keys should then also
            get an <span class="texttt">alias</span> field set, which will cause
            an automatic forwarding of the key to something more &ldquo;user
            friendly&rdquo; like just <span class="texttt">radius</span>.
          </p>

          <p>
            It remains to put the above methods in a &ldquo;script&rdquo; file.
            It is this file that, when compiled, must be linked at runtime
            against Lua<span class="latexlogofont"
              ><span class="latexlogo"
                >T<span class="latexlogosub">e</span>X</span
              ></span
            >.
          </p>

          <figure class="example">
            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000">//</span>
                <span class="textcolor" style="color: #000000">File</span>
                <span class="textcolor" style="color: #000000"
                  >HelloWorldLayout_script</span
                >.<span class="textcolor" style="color: #000000">c++</span
                ><br />
                <br />
                <span class="textcolor" style="color: #000000">#include</span>
                <span class="textcolor" style="color: #000000"
                  ><pgf c gd interfacefromogdf< ogdf span
                    >.<span class="textcolor" style="color: #000000">h&gt;</span
                    ><br />
                    <span class="textcolor" style="color: #000000"
                      >#include</span
                    >
                    <span class="textcolor" style="color: #000000"
                      ><helloworldlayout< span
                        >.<span class="textcolor" style="color: #000000"
                          >h&gt;</span
                        ><br />
                        <br />
                        <span class="textcolor" style="color: #000000"
                          >using</span
                        >
                        <span class="textcolor" style="color: #000000"
                          >namespace</span
                        >
                        <span class="textcolor" style="color: #000000"
                          >ogdf</span
                        >;<br />
                        <span class="textcolor" style="color: #000000"
                          >using</span
                        >
                        <span class="textcolor" style="color: #000000"
                          >namespace</span
                        >
                        <span class="textcolor" style="color: #000000"
                          >scripting</span
                        >;<br />
                        <br />
                        <span class="textcolor" style="color: #000000"
                          >struct</span
                        >
                        <span class="textcolor" style="color: #000000"
                          >HelloWorldLayout_script</span
                        >
                        <span class="textcolor" style="color: #000000"
                          ><a href="tikz-paths#pgf.:">:</a></span
                        >
                        <span class="textcolor" style="color: #000000"
                          >declarations</span
                        >,&numsp;<span class="textcolor" style="color: #000000"
                          >ogdf_runner</span
                        >
                        {<br />
                        &numsp;&numsp;<span
                          class="textcolor"
                          style="color: #000000"
                          >void</span
                        >
                        <span class="textcolor" style="color: #000000"
                          >run</span
                        >
                        <span class="textcolor" style="color: #800080">()</span
                        >&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;{&numsp;...&numsp;<span
                          class="textcolor"
                          style="color: #000000"
                          >see</span
                        >
                        <span class="textcolor" style="color: #000000"
                          ><a href="tikz-shapes#pgf.above">above</a></span
                        >
                        ...&numsp;}<br />
                        &numsp;&numsp;<span
                          class="textcolor"
                          style="color: #000000"
                          >void</span
                        >
                        <span class="textcolor" style="color: #000000"
                          ><a href="tikz-graphs#pgf.declare">declare</a></span
                        >
                        <span class="textcolor" style="color: #800080"
                          >(script s)</span
                        >&numsp;{&numsp;...&numsp;<span
                          class="textcolor"
                          style="color: #000000"
                          >see</span
                        >
                        <span class="textcolor" style="color: #000000"
                          ><a href="tikz-shapes#pgf.above">above</a></span
                        >
                        ...&numsp;}<br />
                        };<br />
                        <br />
                        <span class="textcolor" style="color: #000000"
                          >extern</span
                        >
                        <span class="textcolor" style="color: #000000"
                          >"C"</span
                        >
                        <span class="textcolor" style="color: #000000"
                          >int</span
                        >
                        <span class="textcolor" style="color: #000000"
                          >luaopen_my_path_HelloWorldLayout_script</span
                        >
                        <span class="textcolor" style="color: #800080"
                          >(struct lua_State *state)</span
                        >&numsp;{<br />
                        &numsp;&numsp;<span
                          class="textcolor"
                          style="color: #000000"
                          >script</span
                        >
                        <span class="textcolor" style="color: #800080"
                          >(state)</span
                        >.<span class="textcolor" style="color: #000000"
                          ><a href="tikz-graphs#pgf.declare">declare</a></span
                        >
                        <span class="textcolor" style="color: #800080"
                          >(new HelloWorldLayout_script)</span
                        >;<br />
                        &numsp;&numsp;<span
                          class="textcolor"
                          style="color: #000000"
                          >return</span
                        >
                        <span class="textcolor" style="color: #000000">0</span
                        >;<br />
                        }<br /> </helloworldlayout<></span></pgf></span
              ></code>
            </div>
          </figure>
          <h6 id="autosec-4868">
            <span class="sectionnumber" id="sec-37.4.3">37.4.3&emsp;</span
            >Documenting OGDF Algorithms<a
              class="anchor-link"
              href="#sec-37.4.3"
              >&para;</a
            >
          </h6>
          <a id="pgfmanual-autopage-4868"></a>

          <p>
            As explained in Section&nbsp;<a
              href="gd-algorithms-in-c#section-gd-documenting-c-algos"
              >37.2.2</a
            >, we can add external documentation to algorithms written in C and,
            using the <span class="texttt">documentation_in</span> method of the
            <span class="texttt">key</span> class, we can use the exact same
            method to document <span class="textsc">ogdf</span> algorithms.
          </p>

          <p>
            I strongly recommend making use of this feature since, currently,
            the documentation of many <span class="textsc">ogdf</span> classes
            is sketchy at best and using
            <span class="tikzname">TikZ</span> examples seems to be a good way
            of explaining the effect of the different parameters algorithms
            offer.
          </p>
          <h6 id="autosec-4869">
            <span class="sectionnumber" id="sec-37.4.4">37.4.4&emsp;</span>The
            Interface From OGDF<a class="anchor-link" href="#sec-37.4.4"
              >&para;</a
            >
          </h6>
          <a id="pgfmanual-autopage-4869"></a>

          <p>
            The support for <span class="textsc">ogdf</span> offered inside
            <span class="texttt">InterfaceFromOGDF.h</span> is just the class
            <span class="texttt">ogdf_runner</span> we saw already in the
            example. In addition, there is also a wrapper class
            <span class="texttt">ogdf_function_runner</span> that allows you to
            wrap an algorithm implemented in a function that uses
            <span class="textsc">ogdf</span>, but I expect this to be the case
            only rarely.
          </p>
        </section>
      </main>

      <footer>
        <div class_="footer-left">
          <a href="https://github.com/pgf-tikz/pgf">Github</a> &middot;
          <a href="/license">License</a> &middot;
          <a href="https://ctan.org/pkg/pgf">CTAN</a> &middot;
          <a href="https://pgf-tikz.github.io/pgf/pgfmanual.pdf">PDF version</a>
          &middot;
          <a href="https://github.com/DominikPeters/pgf-tikz-html-manual"
            >About this HTML version</a
          >
        </div>
        <div class_="footer-right">
          <em>Manual last updated: 2022-04-23</em>
        </div>
      </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@alpha"></script>
    <script>
      docsearch({
        apiKey: "ae66ec3fc9df4b52b4d6f24fc8508fd3",
        indexName: "tikz.dev",
        appId: "Q70NNMA9GC",
        container: "#search",
      });
    </script>
  </body>
</html>
