<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta content="LaTeX Lwarp package" name="generator" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Matrices - PGF/TikZ Manual</title>
    <link href="style.css" rel="stylesheet" type="text/css" />

    <script>
      // Lwarp MathJax emulation code
      //
      // Based on code by Davide P. Cervone.
      // Equation numbering: https://github.com/mathjax/MathJax/issues/2427
      // Starred and ifnextchar macros: https://github.com/mathjax/MathJax/issues/2428
      // \left, \right delimiters: https://github.com/mathjax/MathJax/issues/2535
      //
      // Modified by Brian Dunn to adjust equation numbering and add subequations.
      //
      // LaTeX can use \seteqnumber{subequations?}{section}{number} before each equation.
      // subequations? is 0 usually, 1 if inside subequations.
      // section is a string printed as-is, or empty.
      // number is auto-incremented by MathJax between equations.
      //
      MathJax = {
        subequations: "0",
        section: "",
        loader: {
          load: ["[tex]/tagformat", "[tex]/textmacros"],
        },
        startup: {
          ready() {
            // These would be replaced by import commands if you wanted to make
            // a proper extension.
            const Configuration =
              MathJax._.input.tex.Configuration.Configuration;
            const CommandMap = MathJax._.input.tex.SymbolMap.CommandMap;
            const Macro = MathJax._.input.tex.Symbol.Macro;
            const TexError = MathJax._.input.tex.TexError.default;
            const ParseUtil = MathJax._.input.tex.ParseUtil.default;
            const expandable = MathJax._.util.Options.expandable;

            // Insert the replacement string into the TeX string, and check
            // that there haven't been too many maxro substitutions (prevents
            // infinite loops).
            const useArgument = (parser, text) => {
              parser.string = ParseUtil.addArgs(
                parser,
                text,
                parser.string.slice(parser.i)
              );
              parser.i = 0;
              if (
                ++parser.macroCount > parser.configuration.options.maxMacros
              ) {
                throw new TexError(
                  "MaxMacroSub1",
                  "MathJax maximum macro substitution count exceeded; " +
                    "is there a recursive macro call?"
                );
              }
            };

            // Create the command map for:
            // \ifstar, \ifnextchar, \ifblank, \ifstrequal, \seteqnumber
            new CommandMap(
              "Lwarp-macros",
              {
                ifstar: "IfstarFunction",
                ifnextchar: "IfnextcharFunction",
                ifblank: "IfblankFunction",
                ifstrequal: "IfstrequalFunction",
                seteqnumber: "SeteqnumberFunction",
              },
              {
                // This function implements an ifstar macro.
                IfstarFunction(parser, name) {
                  const resultstar = parser.GetArgument(name);
                  const resultnostar = parser.GetArgument(name);
                  const star = parser.GetStar(); // true if there is a *
                  useArgument(parser, star ? resultstar : resultnostar);
                },

                // This function implements an ifnextchar macro.
                IfnextcharFunction(parser, name) {
                  let whichchar = parser.GetArgument(name);
                  if (whichchar.match(/^(?:0x[0-9A-F]+|[0-9]+)$/i)) {
                    // $ syntax highlighting
                    whichchar = String.fromCodePoint(parseInt(whichchar));
                  }
                  const resultnextchar = parser.GetArgument(name);
                  const resultnotnextchar = parser.GetArgument(name);
                  const gotchar = parser.GetNext() === whichchar;
                  useArgument(
                    parser,
                    gotchar ? resultnextchar : resultnotnextchar
                  );
                },

                // This function implements an ifblank macro.
                IfblankFunction(parser, name) {
                  const blankarg = parser.GetArgument(name);
                  const resultblank = parser.GetArgument(name);
                  const resultnotblank = parser.GetArgument(name);
                  const isblank = blankarg.trim() == "";
                  useArgument(parser, isblank ? resultblank : resultnotblank);
                },

                // This function implements an ifstrequal macro.
                IfstrequalFunction(parser, name) {
                  const strequalfirst = parser.GetArgument(name);
                  const strequalsecond = parser.GetArgument(name);
                  const resultequal = parser.GetArgument(name);
                  const resultnotequal = parser.GetArgument(name);
                  const isequal = strequalfirst == strequalsecond;
                  useArgument(parser, isequal ? resultequal : resultnotequal);
                },

                // This function modifies the equation numbers.
                SeteqnumberFunction(parser, name) {
                  // Get the macro parameters
                  const star = parser.GetStar(); // true if there is a *
                  const optBrackets = parser.GetBrackets(name); // contents of optional brackets
                  const newsubequations = parser.GetArgument(name); // the subequations argument
                  const neweqsection = parser.GetArgument(name); // the eq section argument
                  const neweqnumber = parser.GetArgument(name); // the eq number argument
                  MathJax.config.subequations = newsubequations; // a string with boolean meaning
                  MathJax.config.section = neweqsection; // a string with numeric meaning
                  parser.tags.counter = parser.tags.allCounter = neweqnumber;
                },
              }
            );

            // Create the Lwarp-macros package
            Configuration.create("Lwarp-macros", {
              handler: { macro: ["Lwarp-macros"] },
            });

            MathJax.startup.defaultReady();

            // For forward references:
            MathJax.startup.input[0].preFilters.add(({ math }) => {
              if (math.inputData.recompile) {
                MathJax.config.subequations =
                  math.inputData.recompile.subequations;
                MathJax.config.section = math.inputData.recompile.section;
              }
            });
            MathJax.startup.input[0].postFilters.add(({ math }) => {
              if (math.inputData.recompile) {
                math.inputData.recompile.subequations =
                  MathJax.config.subequations;
                math.inputData.recompile.section = MathJax.config.section;
              }
            });

            // For \left, \right with unicode-math:
            const { DelimiterMap } = MathJax._.input.tex.SymbolMap;
            const { Symbol } = MathJax._.input.tex.Symbol;
            const { MapHandler } = MathJax._.input.tex.MapHandler;
            const delimiter = MapHandler.getMap("delimiter");
            delimiter.add("\\lBrack", new Symbol("\\lBrack", "\u27E6"));
            delimiter.add("\\rBrack", new Symbol("\\rBrack", "\u27E7"));
            delimiter.add("\\lAngle", new Symbol("\\lAngle", "\u27EA"));
            delimiter.add("\\rAngle", new Symbol("\\rAngle", "\u27EB"));
            delimiter.add("\\lbrbrak", new Symbol("\\lbrbrak", "\u2772"));
            delimiter.add("\\rbrbrak", new Symbol("\\rbrbrak", "\u2773"));
            delimiter.add("\\lbag", new Symbol("\\lbag", "\u27C5"));
            delimiter.add("\\rbag", new Symbol("\\rbag", "\u27C6"));
            delimiter.add(
              "\\llparenthesis",
              new Symbol("\\llparenthesis", "\u2987")
            );
            delimiter.add(
              "\\rrparenthesis",
              new Symbol("\\rrparenthesis", "\u2988")
            );
            delimiter.add("\\llangle", new Symbol("\\llangle", "\u2989"));
            delimiter.add("\\rrangle", new Symbol("\\rrangle", "\u298A"));
            delimiter.add("\\Lbrbrak", new Symbol("\\Lbrbrak", "\u27EC"));
            delimiter.add("\\Rbrbrak", new Symbol("\\Rbrbrak", "\u27ED"));
            delimiter.add("\\lBrace", new Symbol("\\lBrace", "\u2983"));
            delimiter.add("\\rBrace", new Symbol("\\rBrace", "\u2984"));
            delimiter.add("\\lParen", new Symbol("\\lParen", "\u2985"));
            delimiter.add("\\rParen", new Symbol("\\rParen", "\u2986"));
            delimiter.add("\\lbrackubar", new Symbol("\\lbrackubar", "\u298B"));
            delimiter.add("\\rbrackubar", new Symbol("\\rbrackubar", "\u298C"));
            delimiter.add(
              "\\lbrackultick",
              new Symbol("\\lbrackultick", "\u298D")
            );
            delimiter.add(
              "\\rbracklrtick",
              new Symbol("\\rbracklrtick", "\u298E")
            );
            delimiter.add(
              "\\lbracklltick",
              new Symbol("\\lbracklltick", "\u298F")
            );
            delimiter.add(
              "\\rbrackurtick",
              new Symbol("\\rbrackurtick", "\u2990")
            );
            delimiter.add("\\langledot", new Symbol("\\langledot", "\u2991"));
            delimiter.add("\\rangledot", new Symbol("\\rangledot", "\u2992"));
            delimiter.add("\\lparenless", new Symbol("\\lparenless", "\u2993"));
            delimiter.add("\\rparengtr", new Symbol("\\rparengtr", "\u2994"));
            delimiter.add("\\Lparengtr", new Symbol("\\Lparengtr", "\u2995"));
            delimiter.add("\\Rparenless", new Symbol("\\Rparenless", "\u2996"));
            delimiter.add("\\lblkbrbrak", new Symbol("\\lblkbrbrak", "\u2997"));
            delimiter.add("\\rblkbrbrak", new Symbol("\\rblkbrbrak", "\u2998"));
            delimiter.add("\\lvzigzag", new Symbol("\\lvzigzag", "\u29D8"));
            delimiter.add("\\rvzigzag", new Symbol("\\rvzigzag", "\u29D9"));
            delimiter.add("\\Lvzigzag", new Symbol("\\Lvzigzag", "\u29DA"));
            delimiter.add("\\Rvzigzag", new Symbol("\\Rvzigzag", "\u29DB"));
            delimiter.add(
              "\\lcurvyangle",
              new Symbol("\\lcurvyangle", "\u29FC")
            );
            delimiter.add(
              "\\rcurvyangle",
              new Symbol("\\rcurvyangle", "\u29FD")
            );
            delimiter.add("\\Vvert", new Symbol("\\Vvert", "\u2980"));
          }, // ready
        }, // startup

        tex: {
          packages: { "[+]": ["tagformat", "Lwarp-macros", "textmacros"] },
          tags: "ams",
          tagformat: {
            number: function (n) {
              if (MathJax.config.subequations == 0)
                return MathJax.config.section + n;
              else return MathJax.config.section + String.fromCharCode(96 + n);
            },
          },
        },
      };
    </script>

    <script
      async
      id="MathJax-script"
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"
    ></script>

    <script src="pgfmanual.js"></script>

    <link href="https://unpkg.com/@docsearch/css@alpha" rel="stylesheet" />
    <link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png" />
    <link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png" />
    <link
      href="/apple-touch-icon.png"
      rel="apple-touch-icon"
      sizes="180x180"
      type="image/png"
    />
    <link href="/site.webmanifest" rel="manifest" />
  </head>
  <body>
    <a id="pgfmanual-autopage-8049"></a>

    <div class="bodyandsidetoc grid-container">
      <header>
        <strong><a href="/">PGF/Ti<i>k</i>Z Manual</a></strong>
        <div id="search"></div>
      </header>
      <div class="sidetoccontainer" id="local-toc-container">
        <nav class="sidetoc">
          <div class="sidetoctitle"><p>On this page</p></div>
          <div class="sidetoccontents">
            <p><a class="tocsubsection" href="#sec-106.1">Overview</a></p>
            <p>
              <a class="tocsubsection" href="#sec-106.2"
                >Cell Pictures and Their Alignment</a
              >
            </p>
            <p>
              <a class="tocsubsection" href="#sec-106.3">The Matrix Command</a>
            </p>
            <p>
              <a class="tocsubsection" href="#sec-106.4"
                >Row and Column Spacing</a
              >
            </p>
            <p><a class="tocsubsection" href="#sec-106.5">Callbacks</a></p>
          </div>
        </nav>
      </div>
      <div class="sidetoccontainer" id="chapter-toc-container">
        <nav class="sidetoc">
          <div class="sidetoctitle">
            <p>
              <span class="sidetocthetitle"
                >The <span class="tikzname">TikZ</span> and PGF Packages<br />
                Manual for version 3.1.9a</span
              >
            </p>

            <p>Contents</p>
          </div>

          <div class="sidetoccontents">
            <p></p>

            <p>
              <a class="linkintro" href="/">Introduction</a>
            </p>

            <p>
              <a class="tocpart" href="tutorials-guidelines"
                >Tutorials and Guidelines</a
              >
            </p>

            <p>
              <a class="tocpart" href="install"
                >Installation and Configuration</a
              >
            </p>

            <p>
              <a class="tocpart" href="tikz">Ti<em>k</em>Z</a>
            </p>

            <p>
              <a class="tocpart" href="gd">Graph Drawing</a>
            </p>

            <p>
              <a class="tocpart" href="libraries">Libraries</a>
            </p>

            <p>
              <a class="tocpart" href="dv">Data Visualization</a>
            </p>

            <p>
              <a class="tocpart" href="utilities">Utilities</a>
            </p>

            <p>
              <a class="tocpart" href="math"
                >Mathematical and Object-Oriented Engines</a
              >
            </p>

            <p class="current-part">
              <a class="tocpart" href="base">The Basic Layer</a>
            </p>

            <p class="current-part">
              <a class="tocsection" href="base-design">Design Principles</a>
            </p>

            <p class="current-part">
              <a class="tocsection" href="base-scopes"
                >Hierarchical Structures: Package, Environments, Scopes, and
                Text</a
              >
            </p>

            <p class="current-part">
              <a class="tocsection" href="base-points"
                >Specifying Coordinates</a
              >
            </p>

            <p class="current-part">
              <a class="tocsection" href="base-paths">Constructing Paths</a>
            </p>

            <p class="current-part">
              <a class="tocsection" href="base-decorations">Decorations</a>
            </p>

            <p class="current-part">
              <a class="tocsection" href="base-actions">Using Paths</a>
            </p>

            <p class="current-part">
              <a class="tocsection" href="base-arrows"
                >Defining New Arrow Tip Kinds</a
              >
            </p>

            <p class="current-part">
              <a class="tocsection" href="base-nodes">Nodes and Shapes</a>
            </p>

            <p class="current current-part">
              <a class="tocsection" href="base-matrices">Matrices</a>
            </p>

            <p class="current-part">
              <a class="tocsection" href="base-transformations"
                >Coordinate, Canvas, and Nonlinear Transformations</a
              >
            </p>

            <p class="current-part">
              <a class="tocsection" href="base-patterns">Patterns</a>
            </p>

            <p class="current-part">
              <a class="tocsection" href="base-images"
                >Declaring and Using Images</a
              >
            </p>

            <p class="current-part">
              <a class="tocsection" href="base-external"
                >Externalizing Graphics</a
              >
            </p>

            <p class="current-part">
              <a class="tocsection" href="base-plots">Creating Plots</a>
            </p>

            <p class="current-part">
              <a class="tocsection" href="base-layers">Layered Graphics</a>
            </p>

            <p class="current-part">
              <a class="tocsection" href="base-shadings">Shadings</a>
            </p>

            <p class="current-part">
              <a class="tocsection" href="base-transparency">Transparency</a>
            </p>

            <p class="current-part">
              <a class="tocsection" href="base-animations">Animations</a>
            </p>

            <p class="current-part">
              <a class="tocsection" href="base-internalregisters"
                >Adding libraries to <span class="textsc">pgf</span>: temporary
                registers</a
              >
            </p>

            <p class="current-part">
              <a class="tocsection" href="base-quick">Quick Commands</a>
            </p>

            <p>
              <a class="tocpart" href="pgfsys">The System Layer</a>
            </p>
          </div>
        </nav>
      </div>

      <main class="bodycontainer">
        <section class="textbody">
          <h1>
            The <span class="tikzname">TikZ</span> and PGF Packages<br />
            Manual for version 3.1.9a
          </h1>
          <h2 class="inserted">The Basic Layer</h2>

          <!--MathJax customizations:-->

          <div class="hidden">
            \(\newcommand{\footnotename}{footnote}\) \(\def \LWRfootnote {1}\)
            \(\newcommand {\footnote }[2][\LWRfootnote ]{{}^{\mathrm {#1}}}\)
            \(\newcommand {\footnotemark }[1][\LWRfootnote ]{{}^{\mathrm
            {#1}}}\) \(\let \LWRorighspace \hspace \) \(\renewcommand {\hspace
            }{\ifstar \LWRorighspace \LWRorighspace }\) \(\newcommand
            {\mathnormal }[1]{{#1}}\) \(\newcommand \ensuremath [1]{#1}\)
            \(\newcommand {\LWRframebox }[2][]{\fbox {#2}} \newcommand
            {\framebox }[1][]{\LWRframebox } \) \(\newcommand {\setlength
            }[2]{}\) \(\newcommand {\addtolength }[2]{}\) \(\newcommand
            {\setcounter }[2]{}\) \(\newcommand {\addtocounter }[2]{}\)
            \(\newcommand {\arabic }[1]{}\) \(\newcommand {\number }[1]{}\)
            \(\newcommand {\noalign }[1]{\text {#1}\notag \\}\) \(\newcommand
            {\cline }[1]{}\) \(\newcommand {\directlua }[1]{\text
            {(directlua)}}\) \(\newcommand {\luatexdirectlua }[1]{\text
            {(directlua)}}\) \(\newcommand {\protect }{}\) \(\def
            \LWRabsorbnumber #1 {}\) \(\def \LWRabsorbquotenumber "#1 {}\)
            \(\newcommand {\LWRabsorboption }[1][]{}\) \(\newcommand
            {\LWRabsorbtwooptions }[1][]{\LWRabsorboption }\) \(\def \mathchar
            {\ifnextchar "\LWRabsorbquotenumber \LWRabsorbnumber }\) \(\def
            \mathcode #1={\mathchar }\) \(\let \delcode \mathcode \) \(\let
            \delimiter \mathchar \) \(\def \oe {\unicode {x0153}}\) \(\def \OE
            {\unicode {x0152}}\) \(\def \ae {\unicode {x00E6}}\) \(\def \AE
            {\unicode {x00C6}}\) \(\def \aa {\unicode {x00E5}}\) \(\def \AA
            {\unicode {x00C5}}\) \(\def \o {\unicode {x00F8}}\) \(\def \O
            {\unicode {x00D8}}\) \(\def \l {\unicode {x0142}}\) \(\def \L
            {\unicode {x0141}}\) \(\def \ss {\unicode {x00DF}}\) \(\def \SS
            {\unicode {x1E9E}}\) \(\def \dag {\unicode {x2020}}\) \(\def \ddag
            {\unicode {x2021}}\) \(\def \P {\unicode {x00B6}}\) \(\def
            \copyright {\unicode {x00A9}}\) \(\def \pounds {\unicode {x00A3}}\)
            \(\let \LWRref \ref \) \(\renewcommand {\ref }{\ifstar \LWRref
            \LWRref }\) \( \newcommand {\multicolumn }[3]{#3}\) \(\require
            {textcomp}\) \( \newcommand {\meta }[1]{\langle \textit {#1}\rangle
            } \) \(\newcommand {\intertext }[1]{\text {#1}\notag \\}\) \(\let
            \Hat \hat \) \(\let \Check \check \) \(\let \Tilde \tilde \) \(\let
            \Acute \acute \) \(\let \Grave \grave \) \(\let \Dot \dot \) \(\let
            \Ddot \ddot \) \(\let \Breve \breve \) \(\let \Bar \bar \) \(\let
            \Vec \vec \)
          </div>

          <p></p>
          <h4 id="autosec-8050">
            <a id="section-base-matrices"></a
            ><span class="sectionnumber">106&emsp;</span>Matrices
          </h4>
          <a id="pgfmanual-autopage-8050"></a>
          <a id="pgfmanual-autofile-115"></a>

          <div class="manualentry">
            <div class="entryheadline">
              <p>
                <span class="hl-def"
                  ><kbd
                    >\usepgfmodule{<span
                      class="textcolor"
                      style="color: #bf0000"
                      >matrix</span
                    >} %
                    <span class="latexlogofont"
                      ><span class="latexlogo"
                        >L<span class="latexlogosup">a</span>T<span
                          class="latexlogosub"
                          >e</span
                        >X</span
                      ></span
                    >
                    and plain
                    <span class="latexlogofont"
                      ><span class="latexlogo"
                        >T<span class="latexlogosub">e</span>X</span
                      ></span
                    >
                    and pure pgf</kbd
                  ></span
                >
              </p>
            </div>
            <div class="entryheadline">
              <p>
                <span class="hl-def"
                  ><kbd
                    >\usepgfmodule[<span
                      class="textcolor"
                      style="color: #bf0000"
                      >matrix</span
                    >] % Con<span class="latexlogofont"
                      ><span class="latexlogo"
                        >T<span class="latexlogosub">e</span>X</span
                      ></span
                    >t and pure pgf</kbd
                  ></span
                >
              </p>
            </div>
            <p>The present section documents the commands of this module.</p>
          </div>
          <h5 id="autosec-8052">
            <span class="sectionnumber" id="sec-106.1">106.1&emsp;</span
            >Overview<a class="anchor-link" href="#sec-106.1">&para;</a>
          </h5>
          <a id="pgfmanual-autopage-8052"></a>

          <p>
            Matrices are a mechanism for aligning several so-called cell
            pictures horizontally and vertically. The resulting alignment is
            placed in a normal node and the command for creating matrices,
            <span class="texttt">\pgfmatrix</span>, takes options very similar
            to the <span class="texttt">\pgfnode</span> command.
          </p>

          <p>
            In the following, the basic idea behind the alignment mechanism is
            explained first. Then the command
            <span class="texttt">\pgfmatrix</span> is explained. At the end of
            the section, additional ways of modifying the width of columns and
            rows are discussed.
          </p>
          <h5 id="autosec-8053">
            <span class="sectionnumber" id="sec-106.2">106.2&emsp;</span>Cell
            Pictures and Their Alignment<a class="anchor-link" href="#sec-106.2"
              >&para;</a
            >
          </h5>
          <a id="pgfmanual-autopage-8053"></a>

          <p>
            A matrix consists of rows of <em>cells</em>. Cells are separated
            using the special command
            <span class="texttt">\pgfmatrixnextcell</span>, rows are ended using
            the command <span class="texttt">\pgfmatrixendrow</span> (the
            command <span class="texttt">\\</span> is set up to mean the same as
            <span class="texttt">\pgfmatrixendrow</span> by default). Each cell
            contains a <em>cell picture</em>, although cell pictures are not
            complete pictures as they lack layers. However, each cell picture
            has its own bounding box like a normal picture does. These bounding
            boxes are important for the alignment as explained in the following.
          </p>

          <p>
            Each cell picture will have an origin somewhere in the picture (or
            even outside the picture). The position of these origins are
            important for the alignment: On each row the origins will be on the
            same horizontal line and for each column the origins will also be on
            the same vertical line. These two requirements mean that the cell
            pictures may need to be shifted around so that the origins wind up
            on the same lines. The top of a row is given by the top of the cell
            picture whose bounding box&rsquo;s maximum \(y\)-position is
            largest. Similarly, the bottom of a row is given by the bottom of
            the cell picture whose bounding box&rsquo;s minimum \(y\)-position
            is the most negative. Similarly, the left end of a column is given
            by the left end of the cell whose bounding box&rsquo;s
            \(x\)-position is the most negative; and similarly for the right end
            of a column.
          </p>

          <figure class="example">
            <div class="example-image">
              <p>
                <span class="lateximagesource" id="lateximage-pgfmanual-3233"
                  ><!--
1 2 3 4




5 6 7 8
-->
                  <img
                    alt="(-tikz-&nbsp;diagram)"
                    class="lateximage"
                    height="127.418"
                    loading="lazy"
                    src="pgfmanual-images/image-3233.png"
                    style
                    width="118.180"
                /></span>
              </p>
            </div>

            <div class="example-code">
              <button class="clipboardButton" type="button">copy</button>

              <code>
                <br />
                <span class="textcolor" style="color: #000000">\begin</span
                >{<span class="textcolor" style="color: #0000b2"
                  ><a href="tikz-scopes#pgf.tikzpicture">tikzpicture</a></span
                >}[<span class="textcolor" style="color: #008000"
                  ><a href="tikz-coordinates#pgf.x">x</a></span
                >=<span class="textcolor" style="color: #008000">3mm</span
                >,<span class="textcolor" style="color: #008000"
                  ><a href="tikz-coordinates#pgf.y">y</a></span
                >=<span class="textcolor" style="color: #008000">3mm</span
                >,<span class="textcolor" style="color: #008000"
                  ><a href="tikz-actions#pgf.fill">fill</a></span
                >=<span class="textcolor" style="color: #008000">blue!50</span
                >]<br />
                &numsp;&numsp;<span class="textcolor" style="color: #0000b2"
                  >\def</span
                ><span class="textcolor" style="color: #0000b2">\atorig</span
                ><span class="textcolor" style="color: #000000">#1</span>{<span
                  class="textcolor"
                  style="color: #0000b2"
                  ><a href="tikz-shapes#pgf.back/node">\node</a></span
                >[<span class="textcolor" style="color: #008000">black</span
                >]&numsp;<span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.at">at</a></span
                >
                <span class="textcolor" style="color: #800080">(0,0)</span
                >&numsp;{<span class="textcolor" style="color: #0000b2"
                  >\tiny</span
                >&numsp;<span class="textcolor" style="color: #000000">#1</span
                >};}<br />
                <br />
                &numsp;&numsp;<span class="textcolor" style="color: #0000b2"
                  ><a href="base-matrices#pgf.back/pgfmatrix"
                    >\pgfmatrix</a
                  ></span
                >{<span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.rectangle">rectangle</a></span
                >}{<span class="textcolor" style="color: #000000">center</span
                >}{<span class="textcolor" style="color: #000000">mymatrix</span
                >}<br />
                &numsp;&numsp;&numsp;&numsp;{<span
                  class="textcolor"
                  style="color: #0000b2"
                  ><a href="base-actions#pgf.back/pgfusepath"
                    >\pgfusepath</a
                  ></span
                >{}}{<span class="textcolor" style="color: #0000b2"
                  ><a href="base-points#pgf.back/pgfpointorigin"
                    >\pgfpointorigin</a
                  ></span
                >}{}<br />
                &numsp;&numsp;&numsp;&numsp;{<br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #0000b2"
                  ><a href="tikz-actions#pgf.back/fill">\fill</a></span
                >&numsp;<span class="textcolor" style="color: #800080"
                  >(0,-3)</span
                >&numsp;&numsp;<span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.rectangle">rectangle</a></span
                >
                <span class="textcolor" style="color: #800080">(1,1)</span
                >;<span class="textcolor" style="color: #0000b2">\atorig</span
                ><span class="textcolor" style="color: #000000">1</span>
                <span class="textcolor" style="color: #0000b2"
                  ><a href="base-matrices#pgf.back/pgfmatrixnextcell"
                    >\pgfmatrixnextcell</a
                  ></span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #0000b2"
                  ><a href="tikz-actions#pgf.back/fill">\fill</a></span
                >&numsp;<span class="textcolor" style="color: #800080"
                  >(-1,0)</span
                >&numsp;&numsp;<span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.rectangle">rectangle</a></span
                >
                <span class="textcolor" style="color: #800080">(1,1)</span
                >;<span class="textcolor" style="color: #0000b2">\atorig</span
                ><span class="textcolor" style="color: #000000">2</span>
                <span class="textcolor" style="color: #0000b2"
                  ><a href="base-matrices#pgf.back/pgfmatrixnextcell"
                    >\pgfmatrixnextcell</a
                  ></span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #0000b2"
                  ><a href="tikz-actions#pgf.back/fill">\fill</a></span
                >&numsp;<span class="textcolor" style="color: #800080"
                  >(-1,-2)</span
                >&numsp;<span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.rectangle">rectangle</a></span
                >
                <span class="textcolor" style="color: #800080">(0,0)</span
                >;<span class="textcolor" style="color: #0000b2">\atorig</span
                ><span class="textcolor" style="color: #000000">3</span>
                <span class="textcolor" style="color: #0000b2"
                  ><a href="base-matrices#pgf.back/pgfmatrixnextcell"
                    >\pgfmatrixnextcell</a
                  ></span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #0000b2"
                  ><a href="tikz-actions#pgf.back/fill">\fill</a></span
                >&numsp;<span class="textcolor" style="color: #800080"
                  >(-1,-1)</span
                >&numsp;<span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.rectangle">rectangle</a></span
                >
                <span class="textcolor" style="color: #800080">(0,3)</span
                >;<span class="textcolor" style="color: #0000b2">\atorig</span
                ><span class="textcolor" style="color: #000000">4</span>
                <span class="textcolor" style="color: #0000b2">\</span
                ><span class="textcolor" style="color: #0000b2">\</span><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #0000b2"
                  ><a href="tikz-actions#pgf.back/fill">\fill</a></span
                >&numsp;<span class="textcolor" style="color: #800080"
                  >(-1,0)</span
                >&numsp;&numsp;<span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.rectangle">rectangle</a></span
                >
                <span class="textcolor" style="color: #800080">(4,1)</span
                >;<span class="textcolor" style="color: #0000b2">\atorig</span
                ><span class="textcolor" style="color: #000000">5</span>
                <span class="textcolor" style="color: #0000b2"
                  ><a href="base-matrices#pgf.back/pgfmatrixnextcell"
                    >\pgfmatrixnextcell</a
                  ></span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #0000b2"
                  ><a href="tikz-actions#pgf.back/fill">\fill</a></span
                >&numsp;<span class="textcolor" style="color: #800080"
                  >(0,-1)</span
                >&numsp;&numsp;<span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.rectangle">rectangle</a></span
                >
                <span class="textcolor" style="color: #800080">(1,1)</span
                >;<span class="textcolor" style="color: #0000b2">\atorig</span
                ><span class="textcolor" style="color: #000000">6</span>
                <span class="textcolor" style="color: #0000b2"
                  ><a href="base-matrices#pgf.back/pgfmatrixnextcell"
                    >\pgfmatrixnextcell</a
                  ></span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #0000b2"
                  ><a href="tikz-actions#pgf.back/fill">\fill</a></span
                >&numsp;<span class="textcolor" style="color: #800080"
                  >(0,0)</span
                >&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #000000"
                  ><a href="tikz-paths#pgf.rectangle">rectangle</a></span
                >
                <span class="textcolor" style="color: #800080">(1,4)</span
                >;<span class="textcolor" style="color: #0000b2">\atorig</span
                ><span class="textcolor" style="color: #000000">7</span>
                <span class="textcolor" style="color: #0000b2"
                  ><a href="base-matrices#pgf.back/pgfmatrixnextcell"
                    >\pgfmatrixnextcell</a
                  ></span
                ><br />
                &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                  class="textcolor"
                  style="color: #0000b2"
                  ><a href="tikz-actions#pgf.back/fill">\fill</a></span
                >&numsp;<span class="textcolor" style="color: #800080"
                  >(-1,-1)</span
                >&numsp;<span class="textcolor" style="color: #000000"
                  ><a href="tikz-paths#pgf.rectangle">rectangle</a></span
                >
                <span class="textcolor" style="color: #800080">(0,0)</span
                >;<span class="textcolor" style="color: #0000b2">\atorig</span
                ><span class="textcolor" style="color: #000000">8</span>
                <span class="textcolor" style="color: #0000b2">\</span
                ><span class="textcolor" style="color: #0000b2">\</span><br />
                &numsp;&numsp;&numsp;&numsp;}<br />
                <span class="textcolor" style="color: #000000">\end</span>{<span
                  class="textcolor"
                  style="color: #0000b2"
                  ><a href="tikz-scopes#pgf.tikzpicture">tikzpicture</a></span
                >}<br />
              </code>
            </div>
          </figure>
          <h5 id="autosec-8056">
            <span class="sectionnumber" id="sec-106.3">106.3&emsp;</span>The
            Matrix Command<a class="anchor-link" href="#sec-106.3">&para;</a>
          </h5>
          <a id="pgfmanual-autopage-8056"></a>

          <p>All matrices are typeset using the following command:</p>

          <div class="manualentry">
            <div class="entryheadline">
              <p>
                <a id="pgf.back/pgfmatrix"></a>
                <span class="hl-def"
                  ><span class="textcolor" style="color: #bf0000"
                    ><kbd>\pgfmatrix</kbd></span
                  >{<span class="angle">&langle;</span><i>shape</i
                  ><span class="angle">&rangle;</span>}{<span class="angle"
                    >&langle;</span
                  ><i>anchor</i><span class="angle">&rangle;</span>}{<span
                    class="angle"
                    >&langle;</span
                  ><i>name</i><span class="angle">&rangle;</span>}{<span
                    class="angle"
                    >&langle;</span
                  ><i>usage</i><span class="angle">&rangle;</span>}{<span
                    class="angle"
                    >&langle;</span
                  ><i>shift</i><span class="angle">&rangle;</span>}{<span
                    class="angle"
                    >&langle;</span
                  ><i>pre-code</i><span class="angle">&rangle;</span>}{<span
                    class="angle"
                    >&langle;</span
                  ><i>matrix cells</i><span class="angle">&rangle;</span>}</span
                >
                <a class="anchor-link" href="#pgf.back/pgfmatrix">&para;</a>
              </p>
            </div>
            <p>
              This command creates a node that contains a matrix. The name of
              the node is <span class="angle">&langle;</span><i>name</i
              ><span class="angle">&rangle;</span>, its shape is
              <span class="angle">&langle;</span><i>shape</i
              ><span class="angle">&rangle;</span> and the node is anchored at
              <span class="angle">&langle;</span><i>anchor</i
              ><span class="angle">&rangle;</span>.
            </p>
            <p>
              The <span class="angle">&langle;</span><i>matrix cell</i
              ><span class="angle">&rangle;</span> parameter contains the cells
              of the matrix. In each cell drawing commands may be given, which
              create a so-called cell picture. For each cell picture a bounding
              box is computed and the cells are aligned according to the rules
              outlined in the previous section.
            </p>
            <p>
              The resulting matrix is used as the
              <span class="texttt">text</span> box of the node. As for a normal
              node, the <span class="angle">&langle;</span><i>usage</i
              ><span class="angle">&rangle;</span> commands are applied, so that
              the path(s) of the resulting node is (are) stroked or filled or
              whatever.
            </p>
            <p>
              <b>Specifying the cells and rows. </b> Even though this command
              uses <span class="texttt">\halign</span> internally, there are two
              special rules for indicating cells:
            </p>

            <p>
              1. Cells in the same row must be separated using the macro
              <span class="texttt">\pgfmatrixnextcell</span> rather than
              <span class="texttt">&amp;</span>. Using
              <span class="texttt">&amp;</span> will result in an error message.
            </p>
            <p>
              However, you can make <span class="texttt">&amp;</span> an active
              character and have it expand to
              <span class="texttt">\pgfmatrixnextcell</span>. This way, it will
              &ldquo;look&rdquo; as if <span class="texttt">&amp;</span> is
              used.
            </p>

            <p>
              2. Rows are ended using the command
              <span class="texttt">\pgfmatrixendrow</span>, but
              <span class="texttt">\\</span> is set up to mean the same by
              default. However, some environments like
              <span class="texttt">{minipage}</span> redefine
              <span class="texttt">\\</span>, so it is good to have
              <span class="texttt">\pgfmatrixendrow</span> as a
              &ldquo;fallback&rdquo;.
            </p>

            <p>
              3. Every row <em>including the last row</em> must be ended using
              the command <span class="texttt">\\</span> or
              <span class="texttt">\pgfmatrixendrow</span>.
            </p>

            <p>
              Both <span class="texttt">\pgfmatrixnextcell</span> and
              <span class="texttt">\pgfmatrixendrow</span> (and, thus, also
              <span class="texttt">\\</span>) take an optional argument as
              explained in the Section&nbsp;<a
                href="base-matrices#section-matrix-spacing"
                >106.4</a
              >
            </p>

            <figure class="example">
              <div class="example-image">
                <p>
                  <span class="lateximagesource" id="lateximage-pgfmanual-3234"
                    ><!--
a b
c d
  -->
                    <img
                      alt="(-tikz-&nbsp;diagram)"
                      class="lateximage"
                      height="30.075"
                      loading="lazy"
                      src="pgfmanual-images/image-3234.png"
                      style
                      width="26.595"
                  /></span>
                </p>
              </div>

              <div class="example-code">
                <button class="clipboardButton" type="button">copy</button>
                <code>
                  <br />
                  <span class="textcolor" style="color: #000000">\begin</span
                  >{<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-scopes#pgf.tikzpicture">tikzpicture</a></span
                  >}<br />
                  &numsp;&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfmatrix"
                      >\pgfmatrix</a
                    ></span
                  >{<span class="textcolor" style="color: #000000"
                    ><a href="tikz-paths#pgf.rectangle">rectangle</a></span
                  >}{<span class="textcolor" style="color: #000000">center</span
                  >}{<span class="textcolor" style="color: #000000"
                    >mymatrix</span
                  >}<br />
                  &numsp;&numsp;&numsp;&numsp;{<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="base-actions#pgf.back/pgfusepath"
                      >\pgfusepath</a
                    ></span
                  >{}}{<span class="textcolor" style="color: #0000b2"
                    ><a href="base-points#pgf.back/pgfpointorigin"
                      >\pgfpointorigin</a
                    ></span
                  >}{}<br />
                  &numsp;&numsp;&numsp;&numsp;{<br />
                  &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;{<span class="textcolor" style="color: #000000"
                    >a</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfmatrixnextcell"
                      >\pgfmatrixnextcell</a
                    ></span
                  >&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;{<span class="textcolor" style="color: #000000"
                    >b</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfmatrixendrow"
                      >\pgfmatrixendrow</a
                    ></span
                  ><br />
                  &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;{<span class="textcolor" style="color: #000000"
                    >c</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfmatrixnextcell"
                      >\pgfmatrixnextcell</a
                    ></span
                  >&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;{<span class="textcolor" style="color: #000000"
                    >d</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfmatrixendrow"
                      >\pgfmatrixendrow</a
                    ></span
                  ><br />
                  &numsp;&numsp;&numsp;&numsp;}<br />
                  <span class="textcolor" style="color: #000000">\end</span
                  >{<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-scopes#pgf.tikzpicture">tikzpicture</a></span
                  >}<br />
                </code>
              </div>
            </figure>
            <p>
              <b>Anchoring matrices at nodes inside the matrix. </b> The
              parameter <span class="angle">&langle;</span><i>shift</i
              ><span class="angle">&rangle;</span> is an additional negative
              shift for the node. Normally, such a shift could be given
              beforehand (that is, the shift could be preapplied to the current
              transformation matrix). However, when
              <span class="angle">&langle;</span><i>shift</i
              ><span class="angle">&rangle;</span> is evaluated, you can refer
              to <em>temporary</em> positions of nodes inside the matrix. In
              detail, the following happens: When the matrix has been typeset,
              all nodes in the matrix temporarily get assigned their positions
              in the matrix box. The origin of this coordinate system is at the
              left baseline end of the matrix box, which corresponds to the
              <span class="texttt">text</span> anchor. The position
              <span class="angle">&langle;</span><i>shift</i
              ><span class="angle">&rangle;</span> is then interpreted inside
              this coordinate system and then used for shifting.
            </p>
            <p>
              This allows you to use the parameter
              <span class="angle">&langle;</span><i>shift</i
              ><span class="angle">&rangle;</span> in the following way: If you
              use <span class="texttt">text</span> as the
              <span class="angle">&langle;</span><i>anchor</i
              ><span class="angle">&rangle;</span> and specify
              <span class="texttt"
                >\pgfpointanchor{inner node}{some anchor}</span
              >
              for the parameter <span class="angle">&langle;</span><i>shift</i
              ><span class="angle">&rangle;</span>, where
              <span class="texttt">inner node</span> is a node that is created
              in the matrix, then the whole matrix will be shifted such that
              <span class="texttt">inner node.some anchor</span> lies at the
              origin of the whole picture.
            </p>
            <p>
              <b>Rotations and scaling. </b> The matrix node is never rotated or
              scaled, because the current coordinate transformation matrix is
              reset (except for the translational part) at the beginning of
              <span class="texttt">\pgfmatrix</span>. This is intentional and
              will not change in the future. If you need to rotate or scale the
              matrix, you must install an appropriate canvas transformation
              yourself.
            </p>
            <p>
              However, nodes and stuff inside the cell pictures can be rotated
              and scaled normally.
            </p>
            <p>
              <b>Callbacks. </b> At the beginning and at the end of each cell
              the special macros
              <span class="texttt">\pgfmatrixbegincode</span>,
              <span class="texttt">\pgfmatrixendcode</span> and possibly
              <span class="texttt">\pgfmatrixemptycode</span> are called. The
              effect is explained in Section&nbsp;<a
                href="base-matrices#section-matrix-callbacks"
                >106.5</a
              >.
            </p>
            <p>
              <b>Executing extra code. </b> The parameter
              <span class="angle">&langle;</span><i>pre-code</i
              ><span class="angle">&rangle;</span> is executed at the beginning
              of the outermost
              <span class="latexlogofont"
                ><span class="latexlogo"
                  >T<span class="latexlogosub">e</span>X</span
                ></span
              >-group enclosing the matrix node. It is inside this
              <span class="latexlogofont"
                ><span class="latexlogo"
                  >T<span class="latexlogosub">e</span>X</span
                ></span
              >-group, but outside the matrix itself. It can be used for
              different purposes:
            </p>

            <p>
              1. It can be used to simplify the next cell macro. For example,
              saying
              <span class="texttt">\let\&amp;=\pgfmatrixnextcell</span> allows
              you to use <span class="texttt">\&amp;</span> instead of
              <span class="texttt">\pgfmatrixnextcell</span>. You can also set
              the catcode of <span class="texttt">&amp;</span> to active.
            </p>

            <p>
              2. It can be used to issue an
              <span class="texttt">\aftergroup</span> command. This allows you
              to regain control after the
              <span class="texttt">\pgfmatrix</span> command. (If you do not
              know the <span class="texttt">\aftergroup</span>
              command, you are probably blessed with a simple and happy life.)
            </p>

            <p>
              <b>Special considerations concerning macro expansion. </b> As said
              before, the matrix is typeset using
              <span class="texttt">\halign</span> internally. This command does
              a lot of strange and magic things like expanding the first macro
              of every cell in a most unusual manner. Here are some effects you
              may wish to be aware of:
            </p>

            <p>
              &bull; It is not necessary to actually mention
              <span class="texttt">\pgfmatrixnextcell</span> or
              <span class="texttt">\pgfmatrixendrow</span> inside the
              <span class="angle">&langle;</span><i>matrix cells</i
              ><span class="angle">&rangle;</span>. It suffices that the macros
              inside <span class="angle">&langle;</span><i>matrix cells</i
              ><span class="angle">&rangle;</span> expand to these macros sooner
              or later.
            </p>

            <p>
              &bull; In particular, you can define clever macros that insert
              columns and rows as needed for special effects.
            </p>
          </div>
          <h5 id="autosec-8059">
            <a id="section-matrix-spacing"></a
            ><span class="sectionnumber" id="sec-106.4">106.4&emsp;</span>Row
            and Column Spacing<a class="anchor-link" href="#sec-106.4"
              >&para;</a
            >
          </h5>
          <a id="pgfmanual-autopage-8059"></a>

          <p>
            It is possible to control the space between columns and rows rather
            detailedly. Two commands are important for the row spacing and two
            commands for the column spacing.
          </p>

          <div class="manualentry">
            <div class="entryheadline">
              <p>
                <a id="pgf.back/pgfsetmatrixcolumnsep"></a>
                <span class="hl-def"
                  ><span class="textcolor" style="color: #bf0000"
                    ><kbd>\pgfsetmatrixcolumnsep</kbd></span
                  >{<span class="angle">&langle;</span><i>sep list</i
                  ><span class="angle">&rangle;</span>}</span
                >
                <a class="anchor-link" href="#pgf.back/pgfsetmatrixcolumnsep"
                  >&para;</a
                >
              </p>
            </div>
            <p>
              This macro sets the default separation list for columns. The
              details of the format of this list are explained in the
              description of the next command.
            </p>
          </div>

          <div class="manualentry">
            <div class="entryheadline">
              <p>
                <a id="pgf.back/pgfmatrixnextcell"></a>
                <span class="hl-def"
                  ><span class="textcolor" style="color: #bf0000"
                    ><kbd>\pgfmatrixnextcell</kbd></span
                  ><span class="textcolor" style="color: #008000"
                    >[<span class="angle">&langle;</span
                    ><i>additional sep list</i
                    ><span class="angle">&rangle;</span>]</span
                  ></span
                >
                <a class="anchor-link" href="#pgf.back/pgfmatrixnextcell"
                  >&para;</a
                >
              </p>
            </div>
            <p>
              This command has two purposes: First, it is used to separate
              cells. Second, by providing the optional argument
              <span class="angle">&langle;</span><i>additional sep list</i
              ><span class="angle">&rangle;</span> you can modify the spacing
              between the columns that are separated by this command.
            </p>
            <p>
              The optional <span class="angle">&langle;</span
              ><i>additional sep list</i><span class="angle">&rangle;</span> may
              only be provided when the
              <span class="texttt">\pgfmatrixnextcell</span> command starts a
              new column. Normally, this will only be the case in the first row,
              but sometimes a later row has more elements than the first row. In
              this case, the
              <span class="texttt">\pgfmatrixnextcell</span> commands that start
              the new columns in the later row may also have the optional
              argument. Once a column has been started, subsequent uses of this
              optional argument for the column have no effect.
            </p>
            <p>
              To determine the space between the two columns that are separated
              by <span class="texttt">\pgfmatrixnextcell</span>, the following
              algorithm is executed:
            </p>

            <p>
              1. Both the default separation list (as set up by
              <span class="texttt">\pgfsetmatrixcolumnsep</span>) and the
              <span class="angle">&langle;</span><i>additional sep list</i
              ><span class="angle">&rangle;</span> are processed, in this order.
              If the <span class="angle">&langle;</span
              ><i>additional sep list</i
              ><span class="angle">&rangle;</span> argument is missing, only the
              default separation list is processed.
            </p>

            <p>
              2. Both lists may contain dimensions, separated by commas, as well
              as occurrences of the keywords
              <span class="texttt">between origins</span> and
              <span class="texttt">between borders</span>.
            </p>

            <p>
              3. All dimensions occurring in either list are added together to
              arrive at a dimension \(d\).
            </p>

            <p>
              4. The last occurrence of either of the keywords is located. If
              neither keyword is present, we proceed as if
              <span class="texttt">between borders</span> were present.
            </p>

            <p>
              At the end of the algorithm, a dimension \(d\) has been computed
              and one of the two <em>modes</em>
              <span class="texttt">between borders</span> and
              <span class="texttt">between origins</span> has been determined.
              Depending on which mode has been determined, the following
              happens:
            </p>

            <p>
              &bull; For the <span class="texttt">between borders</span> mode,
              an additional horizontal space of \(d\) is added between the two
              columns. Note that \(d\) may be negative.
            </p>

            <p>
              &bull; For the <span class="texttt">between origins</span> mode,
              the spacing between the two columns is computed differently:
              Recall that the origins of the cell pictures in both pictures lie
              on two vertical lines. The spacing between the two columns is set
              up such that the horizontal distance between these two lines is
              exactly \(d\).
            </p>
            <p>
              This mode may only be used between columns
              <em>already introduced in the first row</em>.
            </p>

            <p>All of the above rules boil down to the following effects:</p>

            <p>
              &bull; A default spacing between columns should be set up using
              <span class="texttt">\pgfsetmatrixcolumnsep</span>. For example,
              you might say
              <span class="texttt">\pgfsetmatrixcolumnsep{5pt}</span> to have
              columns spaced apart by <span class="texttt">5pt</span>. You could
              say
            </p>
            <pre class="verbatim">
 \pgfsetmatrixcolumnsep{1cm,between origins}

  </pre
            >
            <p>
              to specify that horizontal space between the origins of cell
              pictures in adjacent columns should be 1cm by default &ndash;
              regardless of the actual size of the cell pictures.
            </p>

            <p>
              &bull; You can now use the optional argument of
              <span class="texttt">\pgfmatrixnextcell</span> to locally overrule
              the spacing between two columns. By saying
              <span class="texttt">\pgfmatrixnextcell[5pt]</span> you
              <em>add</em> 5pt to the space between of the two columns,
              regardless of the mode.
            </p>
            <p>
              You can also (locally) change the spacing mode for these two
              columns. For example, even if the normal spacing mode is
              <span class="texttt">between origins</span>, you can say
            </p>
            <pre class="verbatim">
 \pgfmatrixnextcell[5pt,between borders]

</pre
            >
            <p>
              to locally change the mode for these columns to
              <span class="texttt">between borders</span>.
            </p>

            <figure class="example">
              <div class="example-image">
                <p>
                  <span class="lateximagesource" id="lateximage-pgfmanual-3235"
                    ><!--
8 1 6
3 5 7
4 9 2
-->
                    <img
                      alt="(-tikz-&nbsp;diagram)"
                      class="lateximage"
                      height="57.644"
                      loading="lazy"
                      src="pgfmanual-images/image-3235.png"
                      style
                      width="65.077"
                  /></span>
                </p>
              </div>

              <div class="example-code">
                <button class="clipboardButton" type="button">copy</button>
                <code>
                  <br />
                  <span class="textcolor" style="color: #000000">\begin</span
                  >{<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-scopes#pgf.tikzpicture">tikzpicture</a></span
                  >}[<span class="textcolor" style="color: #008000"
                    ><a href="tikz-shapes#pgf.every:node">every node</a></span
                  >/<span class="textcolor" style="color: #0000b2"
                    ><a href="pgfkeys#pgf./handlers/.style">.style</a></span
                  >=<span class="textcolor" style="color: #008000"
                    ><a href="tikz-actions#pgf.draw">draw</a></span
                  >]<br />
                  &numsp;&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfsetmatrixcolumnsep"
                      >\pgfsetmatrixcolumnsep</a
                    ></span
                  >{<span class="textcolor" style="color: #000000">1mm</span
                  >}<br />
                  &numsp;&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfmatrix"
                      >\pgfmatrix</a
                    ></span
                  >{<span class="textcolor" style="color: #000000"
                    ><a href="tikz-paths#pgf.rectangle">rectangle</a></span
                  >}{<span class="textcolor" style="color: #000000">center</span
                  >}{<span class="textcolor" style="color: #000000"
                    >mymatrix</span
                  >}<br />
                  &numsp;&numsp;&numsp;&numsp;{<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="base-actions#pgf.back/pgfusepath"
                      >\pgfusepath</a
                    ></span
                  >{}}{<span class="textcolor" style="color: #0000b2"
                    ><a href="base-points#pgf.back/pgfpointorigin"
                      >\pgfpointorigin</a
                    ></span
                  >}{<span class="textcolor" style="color: #0000b2">\let</span
                  ><span class="textcolor" style="color: #0000b2">\</span
                  ><span class="textcolor" style="color: #000000">&amp;=</span
                  ><span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfmatrixnextcell"
                      >\pgfmatrixnextcell</a
                    ></span
                  >}<br />
                  &numsp;&numsp;{<br />
                  &numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;{<span class="textcolor" style="color: #000000"
                    >8</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span
                  >[<span class="textcolor" style="color: #008000">2mm</span
                  >]&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >{<span class="textcolor" style="color: #000000">1</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span
                  >[<span class="textcolor" style="color: #008000">-1mm</span
                  >]&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;{<span class="textcolor" style="color: #000000"
                    >6</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #0000b2">\</span><br />
                  &numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;{<span class="textcolor" style="color: #000000"
                    >3</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  &numsp;&numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >{<span class="textcolor" style="color: #000000">5</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;{<span class="textcolor" style="color: #000000"
                    >7</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #0000b2">\</span><br />
                  &numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;{<span class="textcolor" style="color: #000000"
                    >4</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  &numsp;&numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >{<span class="textcolor" style="color: #000000">9</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;{<span class="textcolor" style="color: #000000"
                    >2</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #0000b2">\</span><br />
                  &numsp;&numsp;}<br />
                  <span class="textcolor" style="color: #000000">\end</span
                  >{<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-scopes#pgf.tikzpicture">tikzpicture</a></span
                  >}<br />
                </code>
              </div>
            </figure>

            <figure class="example">
              <div class="example-image">
                <p>
                  <span class="lateximagesource" id="lateximage-pgfmanual-3236"
                    ><!--
     11mm
8 1 6
3 5 7
4 9 2
-->
                    <img
                      alt="(-tikz-&nbsp;diagram)"
                      class="lateximage"
                      height="62.151"
                      loading="lazy"
                      src="pgfmanual-images/image-3236.png"
                      style
                      width="89.628"
                  /></span>
                </p>
              </div>

              <div class="example-code">
                <button class="clipboardButton" type="button">copy</button>
                <code>
                  <br />
                  <span class="textcolor" style="color: #000000">\begin</span
                  >{<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-scopes#pgf.tikzpicture">tikzpicture</a></span
                  >}[<span class="textcolor" style="color: #008000"
                    ><a href="tikz-shapes#pgf.every:node">every node</a></span
                  >/<span class="textcolor" style="color: #0000b2"
                    ><a href="pgfkeys#pgf./handlers/.style">.style</a></span
                  >=<span class="textcolor" style="color: #008000"
                    ><a href="tikz-actions#pgf.draw">draw</a></span
                  >]<br />
                  &numsp;&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfsetmatrixcolumnsep"
                      >\pgfsetmatrixcolumnsep</a
                    ></span
                  >{<span class="textcolor" style="color: #000000">1mm</span
                  >}<br />
                  &numsp;&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfmatrix"
                      >\pgfmatrix</a
                    ></span
                  >{<span class="textcolor" style="color: #000000"
                    ><a href="tikz-paths#pgf.rectangle">rectangle</a></span
                  >}{<span class="textcolor" style="color: #000000">center</span
                  >}{<span class="textcolor" style="color: #000000"
                    >mymatrix</span
                  >}<br />
                  &numsp;&numsp;&numsp;&numsp;{<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="base-actions#pgf.back/pgfusepath"
                      >\pgfusepath</a
                    ></span
                  >{}}{<span class="textcolor" style="color: #0000b2"
                    ><a href="base-points#pgf.back/pgfpointorigin"
                      >\pgfpointorigin</a
                    ></span
                  >}{<span class="textcolor" style="color: #0000b2">\let</span
                  ><span class="textcolor" style="color: #0000b2">\</span
                  ><span class="textcolor" style="color: #000000">&amp;=</span
                  ><span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfmatrixnextcell"
                      >\pgfmatrixnextcell</a
                    ></span
                  >}<br />
                  &numsp;&numsp;{<br />
                  &numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;{<span class="textcolor" style="color: #000000"
                    >8</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span
                  >[<span class="textcolor" style="color: #008000">2mm</span
                  >]&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  ><span class="textcolor" style="color: #800080">(a)</span
                  >{<span class="textcolor" style="color: #000000">1</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span
                  >[<span class="textcolor" style="color: #008000">1cm</span
                  >,<span class="textcolor" style="color: #008000"
                    >between origins</span
                  >]&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  ><span class="textcolor" style="color: #800080">(b)</span
                  >{<span class="textcolor" style="color: #000000">6</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #0000b2">\</span><br />
                  &numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;{<span class="textcolor" style="color: #000000"
                    >3</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  &numsp;&numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;&numsp;&numsp;{<span
                    class="textcolor"
                    style="color: #000000"
                    >5</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;&numsp;&numsp;{<span
                    class="textcolor"
                    style="color: #000000"
                    >7</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #0000b2">\</span><br />
                  &numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;{<span class="textcolor" style="color: #000000"
                    >4</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  &numsp;&numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;&numsp;&numsp;{<span
                    class="textcolor"
                    style="color: #000000"
                    >9</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;&numsp;&numsp;{<span
                    class="textcolor"
                    style="color: #000000"
                    >2</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #0000b2">\</span><br />
                  &numsp;&numsp;}<br />
                  &numsp;&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-actions#pgf.back/draw">\draw</a></span
                  >&numsp;[<span class="textcolor" style="color: #008000"
                    ><a href="tikz-graphs#pgf.&lt;-&gt;">&lt;-&gt;</a></span
                  >,<span class="textcolor" style="color: #008000">red</span
                  >,<span class="textcolor" style="color: #008000"
                    ><a href="tikz-actions#pgf.thick">thick</a></span
                  >,<span class="textcolor" style="color: #008000"
                    ><a href="tikz-shapes#pgf.every:node">every node</a></span
                  >/<span class="textcolor" style="color: #0000b2"
                    ><a href="pgfkeys#pgf./handlers/.style">.style</a></span
                  >=]&numsp;<span class="textcolor" style="color: #800080"
                    >(a.center)</span
                  >&numsp;<span class="textcolor" style="color: #000000"
                    ><a href="tikz-paths#pgf.--">--</a></span
                  >
                  <span class="textcolor" style="color: #800080"
                    >(b.center)</span
                  ><br />
                  &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #000000"
                    ><a href="tikz-coordinates#pgf.node">node</a></span
                  >
                  [<span class="textcolor" style="color: #008000"
                    ><a href="tikz-shapes#pgf.above">above</a></span
                  >,<span class="textcolor" style="color: #008000"
                    ><a href="tikz-shapes#pgf.midway">midway</a></span
                  >]&numsp;{<span class="textcolor" style="color: #000000"
                    >11mm</span
                  >};<br />
                  <span class="textcolor" style="color: #000000">\end</span
                  >{<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-scopes#pgf.tikzpicture">tikzpicture</a></span
                  >}<br />
                </code>
              </div>
            </figure>

            <figure class="example">
              <div class="example-image">
                <p>
                  <span class="lateximagesource" id="lateximage-pgfmanual-3237"
                    ><!--
10mm 10mm
8 1 6
3 5 7
4 9 2
   -->
                    <img
                      alt="(-tikz-&nbsp;diagram)"
                      class="lateximage"
                      height="62.296"
                      loading="lazy"
                      src="pgfmanual-images/image-3237.png"
                      style
                      width="112.305"
                  /></span>
                </p>
              </div>

              <div class="example-code">
                <button class="clipboardButton" type="button">copy</button>
                <code>
                  <br />
                  <span class="textcolor" style="color: #000000">\begin</span
                  >{<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-scopes#pgf.tikzpicture">tikzpicture</a></span
                  >}[<span class="textcolor" style="color: #008000"
                    ><a href="tikz-shapes#pgf.every:node">every node</a></span
                  >/<span class="textcolor" style="color: #0000b2"
                    ><a href="pgfkeys#pgf./handlers/.style">.style</a></span
                  >=<span class="textcolor" style="color: #008000"
                    ><a href="tikz-actions#pgf.draw">draw</a></span
                  >]<br />
                  &numsp;&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfsetmatrixcolumnsep"
                      >\pgfsetmatrixcolumnsep</a
                    ></span
                  >{<span class="textcolor" style="color: #000000">1cm</span
                  >,<span class="textcolor" style="color: #000000"
                    >between</span
                  >
                  <span class="textcolor" style="color: #000000">origins</span
                  >}<br />
                  &numsp;&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfmatrix"
                      >\pgfmatrix</a
                    ></span
                  >{<span class="textcolor" style="color: #000000"
                    ><a href="tikz-paths#pgf.rectangle">rectangle</a></span
                  >}{<span class="textcolor" style="color: #000000">center</span
                  >}{<span class="textcolor" style="color: #000000"
                    >mymatrix</span
                  >}<br />
                  &numsp;&numsp;&numsp;&numsp;{<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="base-actions#pgf.back/pgfusepath"
                      >\pgfusepath</a
                    ></span
                  >{}}{<span class="textcolor" style="color: #0000b2"
                    ><a href="base-points#pgf.back/pgfpointorigin"
                      >\pgfpointorigin</a
                    ></span
                  >}{<span class="textcolor" style="color: #0000b2">\let</span
                  ><span class="textcolor" style="color: #0000b2">\</span
                  ><span class="textcolor" style="color: #000000">&amp;=</span
                  ><span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfmatrixnextcell"
                      >\pgfmatrixnextcell</a
                    ></span
                  >}<br />
                  &numsp;&numsp;{<br />
                  &numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;<span class="textcolor" style="color: #800080"
                    >(a)</span
                  >&numsp;{<span class="textcolor" style="color: #000000"
                    >8</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  <span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;<span class="textcolor" style="color: #800080"
                    >(b)</span
                  >&numsp;{<span class="textcolor" style="color: #000000"
                    >1</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span
                  >[<span class="textcolor" style="color: #008000"
                    >between borders</span
                  >]&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;<span class="textcolor" style="color: #800080"
                    >(c)</span
                  >&numsp;{<span class="textcolor" style="color: #000000"
                    >6</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #0000b2">\</span><br />
                  &numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;&numsp;&numsp;&numsp;&numsp;{<span
                    class="textcolor"
                    style="color: #000000"
                    >3</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  <span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;&numsp;&numsp;&numsp;&numsp;{<span
                    class="textcolor"
                    style="color: #000000"
                    >5</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;&numsp;&numsp;&numsp;&numsp;{<span
                    class="textcolor"
                    style="color: #000000"
                    >7</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #0000b2">\</span><br />
                  &numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;&numsp;&numsp;&numsp;&numsp;{<span
                    class="textcolor"
                    style="color: #000000"
                    >4</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  <span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;&numsp;&numsp;&numsp;&numsp;{<span
                    class="textcolor"
                    style="color: #000000"
                    >9</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;&numsp;&numsp;&numsp;&numsp;{<span
                    class="textcolor"
                    style="color: #000000"
                    >2</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #0000b2">\</span><br />
                  &numsp;&numsp;}<br />
                  &numsp;&numsp;<span class="textcolor" style="color: #000000"
                    >\begin</span
                  >{<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-scopes#pgf.scope">scope</a></span
                  >}[<span class="textcolor" style="color: #008000"
                    ><a href="tikz-shapes#pgf.every:node">every node</a></span
                  >/<span class="textcolor" style="color: #0000b2"
                    ><a href="pgfkeys#pgf./handlers/.style">.style</a></span
                  >=]<br />
                  &numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-actions#pgf.back/draw">\draw</a></span
                  >&numsp;[<span class="textcolor" style="color: #008000"
                    ><a href="tikz-graphs#pgf.&lt;-&gt;">&lt;-&gt;</a></span
                  >,<span class="textcolor" style="color: #008000">red</span
                  >,<span class="textcolor" style="color: #008000"
                    ><a href="tikz-actions#pgf.thick">thick</a></span
                  >]&numsp;<span class="textcolor" style="color: #800080"
                    >(a.center)</span
                  >&numsp;<span class="textcolor" style="color: #000000"
                    ><a href="tikz-paths#pgf.--">--</a></span
                  >
                  <span class="textcolor" style="color: #800080"
                    >(b.center)</span
                  >&numsp;<span class="textcolor" style="color: #000000"
                    ><a href="tikz-coordinates#pgf.node">node</a></span
                  >
                  [<span class="textcolor" style="color: #008000"
                    ><a href="tikz-shapes#pgf.above">above</a></span
                  >,<span class="textcolor" style="color: #008000"
                    ><a href="tikz-shapes#pgf.midway">midway</a></span
                  >]&numsp;{<span class="textcolor" style="color: #000000"
                    >10mm</span
                  >};<br />
                  &numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-actions#pgf.back/draw">\draw</a></span
                  >&numsp;[<span class="textcolor" style="color: #008000"
                    ><a href="tikz-graphs#pgf.&lt;-&gt;">&lt;-&gt;</a></span
                  >,<span class="textcolor" style="color: #008000">red</span
                  >,<span class="textcolor" style="color: #008000"
                    ><a href="tikz-actions#pgf.thick">thick</a></span
                  >]&numsp;<span class="textcolor" style="color: #800080"
                    >(b.east)</span
                  >&numsp;<span class="textcolor" style="color: #000000"
                    ><a href="tikz-paths#pgf.--">--</a></span
                  >
                  <span class="textcolor" style="color: #800080">(c.west)</span
                  >&numsp;<span class="textcolor" style="color: #000000"
                    ><a href="tikz-coordinates#pgf.node">node</a></span
                  >
                  [<span class="textcolor" style="color: #008000"
                    ><a href="tikz-shapes#pgf.above">above</a></span
                  >,<span class="textcolor" style="color: #008000"
                    ><a href="tikz-shapes#pgf.midway">midway</a></span
                  >]<br />
                  &numsp;&numsp;&numsp;&numsp;{<span
                    class="textcolor"
                    style="color: #000000"
                    >10mm</span
                  >};<br />
                  &numsp;&numsp;<span class="textcolor" style="color: #000000"
                    >\end</span
                  >{<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-scopes#pgf.scope">scope</a></span
                  >}<br />
                  <span class="textcolor" style="color: #000000">\end</span
                  >{<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-scopes#pgf.tikzpicture">tikzpicture</a></span
                  >}<br />
                </code>
              </div>
            </figure>
          </div>

          <p>
            The mechanism for the between-row-spacing is the same, only the
            commands are called differently.
          </p>

          <div class="manualentry">
            <div class="entryheadline">
              <p>
                <a id="pgf.back/pgfsetmatrixrowsep"></a>
                <span class="hl-def"
                  ><span class="textcolor" style="color: #bf0000"
                    ><kbd>\pgfsetmatrixrowsep</kbd></span
                  >{<span class="angle">&langle;</span><i>sep list</i
                  ><span class="angle">&rangle;</span>}</span
                >
                <a class="anchor-link" href="#pgf.back/pgfsetmatrixrowsep"
                  >&para;</a
                >
              </p>
            </div>
            <p>This macro sets the default separation list for rows.</p>
          </div>

          <div class="manualentry">
            <div class="entryheadline">
              <p>
                <a id="pgf.back/pgfmatrixendrow"></a>
                <span class="hl-def"
                  ><span class="textcolor" style="color: #bf0000"
                    ><kbd>\pgfmatrixendrow</kbd></span
                  ><span class="textcolor" style="color: #008000"
                    >[<span class="angle">&langle;</span
                    ><i>additional sep list</i
                    ><span class="angle">&rangle;</span>]</span
                  ></span
                >
                <a class="anchor-link" href="#pgf.back/pgfmatrixendrow"
                  >&para;</a
                >
              </p>
            </div>
            <p>
              This command ends a line. The optional
              <span class="angle">&langle;</span><i>additional sep list</i
              ><span class="angle">&rangle;</span> is used to determine the
              spacing between the row being ended and the next row. The modes
              and the computation of \(d\) is done in the same way as for
              columns. For the last row the optional argument has no effect.
            </p>
            <p>
              Inside matrices (and only there) the command
              <span class="texttt">\\</span> is set up to mean the same as this
              command.
            </p>
          </div>
          <h5 id="autosec-8068">
            <a id="section-matrix-callbacks"></a
            ><span class="sectionnumber" id="sec-106.5">106.5&emsp;</span
            >Callbacks<a class="anchor-link" href="#sec-106.5">&para;</a>
          </h5>
          <a id="pgfmanual-autopage-8068"></a>

          <p>
            There are three macros that get called at the beginning and end of
            cells. By redefining these macros, which are empty by default, you
            can change the appearance of cells in a very general manner.
          </p>

          <div class="manualentry">
            <div class="entryheadline">
              <p>
                <a id="pgf.back/pgfmatrixemptycode"></a>
                <span class="hl-def"
                  ><span class="textcolor" style="color: #bf0000"
                    ><kbd>\pgfmatrixemptycode</kbd></span
                  ></span
                >
                <a class="anchor-link" href="#pgf.back/pgfmatrixemptycode"
                  >&para;</a
                >
              </p>
            </div>
            <p>
              This macro is executed for empty cells. This means that
              <span class="textsc">pgf</span> uses some macro magic to determine
              whether a cell is empty (it immediately ends with
              <span class="texttt">\pgfmatrixemptycode</span> or
              <span class="texttt">\pgfmatrixendrow</span>) and, if so, put this
              macro inside the cell.
            </p>

            <figure class="example">
              <div class="example-image">
                <p>
                  <span class="lateximagesource" id="lateximage-pgfmanual-3238"
                    ><!--
  a empty b
empty c d empty
   -->
                    <img
                      alt="(-tikz-&nbsp;diagram)"
                      class="lateximage"
                      height="33.651"
                      loading="lazy"
                      src="pgfmanual-images/image-3238.png"
                      style
                      width="162.314"
                  /></span>
                </p>
              </div>

              <div class="example-code">
                <button class="clipboardButton" type="button">copy</button>
                <code>
                  <br />
                  <span class="textcolor" style="color: #000000">\begin</span
                  >{<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-scopes#pgf.tikzpicture">tikzpicture</a></span
                  >}<br />
                  &numsp;&numsp;<span class="textcolor" style="color: #0000b2"
                    >\def</span
                  ><span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfmatrixemptycode"
                      >\pgfmatrixemptycode</a
                    ></span
                  >{<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >{<span class="textcolor" style="color: #000000">empty</span
                  >};}<br />
                  &numsp;&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfmatrix"
                      >\pgfmatrix</a
                    ></span
                  >{<span class="textcolor" style="color: #000000"
                    ><a href="tikz-paths#pgf.rectangle">rectangle</a></span
                  >}{<span class="textcolor" style="color: #000000">center</span
                  >}{<span class="textcolor" style="color: #000000"
                    >mymatrix</span
                  >}<br />
                  &numsp;&numsp;&numsp;&numsp;{<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="base-actions#pgf.back/pgfusepath"
                      >\pgfusepath</a
                    ></span
                  >{}}{<span class="textcolor" style="color: #0000b2"
                    ><a href="base-points#pgf.back/pgfpointorigin"
                      >\pgfpointorigin</a
                    ></span
                  >}{<span class="textcolor" style="color: #0000b2">\let</span
                  ><span class="textcolor" style="color: #0000b2">\</span
                  ><span class="textcolor" style="color: #000000">&amp;=</span
                  ><span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfmatrixnextcell"
                      >\pgfmatrixnextcell</a
                    ></span
                  >}<br />
                  &numsp;&numsp;{<br />
                  &numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;{<span class="textcolor" style="color: #000000"
                    >a</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  <span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;{<span class="textcolor" style="color: #000000"
                    >b</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #0000b2">\</span><br />
                  &numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  <span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >{<span class="textcolor" style="color: #000000">c</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  <span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >&numsp;{<span class="textcolor" style="color: #000000"
                    >d</span
                  >};&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  <span class="textcolor" style="color: #0000b2">\</span
                  ><span class="textcolor" style="color: #0000b2">\</span><br />
                  &numsp;&numsp;}<br />
                  <span class="textcolor" style="color: #000000">\end</span
                  >{<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-scopes#pgf.tikzpicture">tikzpicture</a></span
                  >}<br />
                </code>
              </div>
            </figure>
            <p>
              As can be seen, the macro is not executed for empty cells at the
              end of row when columns are added only later on.
            </p>
          </div>

          <div class="manualentry">
            <div class="entryheadline">
              <p>
                <a id="pgf.back/pgfmatrixbegincode"></a>
                <span class="hl-def"
                  ><span class="textcolor" style="color: #bf0000"
                    ><kbd>\pgfmatrixbegincode</kbd></span
                  ></span
                >
                <a class="anchor-link" href="#pgf.back/pgfmatrixbegincode"
                  >&para;</a
                >
              </p>
            </div>
            <p>
              This macro is executed at the beginning of non-empty cells.
              Correspondingly, <span class="texttt">\pgfmatrixendcode</span> is
              added at the end of every non-empty cell.
            </p>

            <figure class="example">
              <div class="example-image">
                <p>
                  <span class="lateximagesource" id="lateximage-pgfmanual-3239"
                    ><!--
a b c
d e
   -->
                    <img
                      alt="(-tikz-&nbsp;diagram)"
                      class="lateximage"
                      height="40.037"
                      loading="lazy"
                      src="pgfmanual-images/image-3239.png"
                      style
                      width="54.803"
                  /></span>
                </p>
              </div>

              <div class="example-code">
                <button class="clipboardButton" type="button">copy</button>
                <code>
                  <br />
                  <span class="textcolor" style="color: #000000">\begin</span
                  >{<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-scopes#pgf.tikzpicture">tikzpicture</a></span
                  >}<br />
                  &numsp;&numsp;<span class="textcolor" style="color: #0000b2"
                    >\def</span
                  ><span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfmatrixbegincode"
                      >\pgfmatrixbegincode</a
                    ></span
                  >{<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-shapes#pgf.back/node">\node</a></span
                  >[<span class="textcolor" style="color: #008000"
                    ><a href="tikz-actions#pgf.draw">draw</a></span
                  >]<span class="textcolor" style="color: #0000b2">\bgroup</span
                  >}<br />
                  &numsp;&numsp;<span class="textcolor" style="color: #0000b2"
                    >\def</span
                  ><span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfmatrixendcode"
                      >\pgfmatrixendcode</a
                    ></span
                  >{<span class="textcolor" style="color: #0000b2">\egroup</span
                  >;}<br />
                  &numsp;&numsp;<span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfmatrix"
                      >\pgfmatrix</a
                    ></span
                  >{<span class="textcolor" style="color: #000000"
                    ><a href="tikz-paths#pgf.rectangle">rectangle</a></span
                  >}{<span class="textcolor" style="color: #000000">center</span
                  >}{<span class="textcolor" style="color: #000000"
                    >mymatrix</span
                  >}<br />
                  &numsp;&numsp;&numsp;&numsp;{<span
                    class="textcolor"
                    style="color: #0000b2"
                    ><a href="base-actions#pgf.back/pgfusepath"
                      >\pgfusepath</a
                    ></span
                  >{}}{<span class="textcolor" style="color: #0000b2"
                    ><a href="base-points#pgf.back/pgfpointorigin"
                      >\pgfpointorigin</a
                    ></span
                  >}{<span class="textcolor" style="color: #0000b2">\let</span
                  ><span class="textcolor" style="color: #0000b2">\</span
                  ><span class="textcolor" style="color: #000000">&amp;=</span
                  ><span class="textcolor" style="color: #0000b2"
                    ><a href="base-matrices#pgf.back/pgfmatrixnextcell"
                      >\pgfmatrixnextcell</a
                    ></span
                  >}<br />
                  &numsp;&numsp;{<br />
                  &numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #000000"
                    >a</span
                  >
                  <span class="textcolor" style="color: #0000b2">\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  <span class="textcolor" style="color: #000000">b</span>
                  <span class="textcolor" style="color: #0000b2">\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  <span class="textcolor" style="color: #000000">c</span>
                  <span class="textcolor" style="color: #0000b2">\</span
                  ><span class="textcolor" style="color: #0000b2">\</span><br />
                  &numsp;&numsp;&numsp;&numsp;<span
                    class="textcolor"
                    style="color: #000000"
                    >d</span
                  >
                  <span class="textcolor" style="color: #0000b2">\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  &numsp;&numsp;<span class="textcolor" style="color: #0000b2"
                    >\</span
                  ><span class="textcolor" style="color: #000000">&amp;</span>
                  <span class="textcolor" style="color: #000000">e</span>
                  <span class="textcolor" style="color: #0000b2">\</span
                  ><span class="textcolor" style="color: #0000b2">\</span><br />
                  &numsp;&numsp;}<br />
                  <span class="textcolor" style="color: #000000">\end</span
                  >{<span class="textcolor" style="color: #0000b2"
                    ><a href="tikz-scopes#pgf.tikzpicture">tikzpicture</a></span
                  >}<br />
                </code>
              </div>
            </figure>
            <p>
              Note that between
              <span class="texttt">\pgfmatrixbegincode</span> and
              <span class="texttt">\pgfmatrixendcode</span> there will
              <em>not</em> only be the contents of the cell. Rather,
              <span class="textsc">pgf</span> will add some (invisible) commands
              for book-keeping purposes that involve
              <span class="texttt">\let</span> and
              <span class="texttt">\gdef</span>. In particular, it is not a good
              idea to have <span class="texttt">\pgfmatrixbegincode</span> end
              with <span class="texttt">\csname</span> and
              <span class="texttt">\pgfmatrixendcode</span> start with
              <span class="texttt">\endcsname</span>.
            </p>
          </div>

          <div class="manualentry">
            <div class="entryheadline">
              <p>
                <a id="pgf.back/pgfmatrixendcode"></a>
                <span class="hl-def"
                  ><span class="textcolor" style="color: #bf0000"
                    ><kbd>\pgfmatrixendcode</kbd></span
                  ></span
                >
                <a class="anchor-link" href="#pgf.back/pgfmatrixendcode"
                  >&para;</a
                >
              </p>
            </div>
            <p>See the explanation above.</p>
          </div>

          <p>
            The following two counters allow you to access the current row and
            current column in a callback:
          </p>

          <div class="manualentry">
            <div class="entryheadline">
              <p>
                <a id="pgf.back/pgfmatrixcurrentrow"></a>
                <span class="hl-def"
                  ><span class="textcolor" style="color: #bf0000"
                    ><kbd>\pgfmatrixcurrentrow</kbd></span
                  ></span
                >
                <a class="anchor-link" href="#pgf.back/pgfmatrixcurrentrow"
                  >&para;</a
                >
              </p>
            </div>
            <p>
              This counter stores the current row of the current cell of the
              matrix. Do not even think about changing this counter.
            </p>
          </div>

          <div class="manualentry">
            <div class="entryheadline">
              <p>
                <a id="pgf.back/pgfmatrixcurrentcolumn"></a>
                <span class="hl-def"
                  ><span class="textcolor" style="color: #bf0000"
                    ><kbd>\pgfmatrixcurrentcolumn</kbd></span
                  ></span
                >
                <a class="anchor-link" href="#pgf.back/pgfmatrixcurrentcolumn"
                  >&para;</a
                >
              </p>
            </div>
            <p>
              This counter stores the current column of the current cell of the
              matrix.
            </p>
          </div>
        </section>
      </main>

      <footer>
        <div class_="footer-left">
          <a href="https://github.com/pgf-tikz/pgf">Github</a> &middot;
          <a href="/license">License</a> &middot;
          <a href="https://ctan.org/pkg/pgf">CTAN</a> &middot;
          <a href="https://pgf-tikz.github.io/pgf/pgfmanual.pdf">PDF version</a>
          &middot;
          <a href="https://github.com/DominikPeters/pgf-tikz-html-manual"
            >About this HTML version</a
          >
        </div>
        <div class_="footer-right">
          <em>Manual last updated: 2022-04-23</em>
        </div>
      </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@alpha"></script>
    <script>
      docsearch({
        apiKey: "ae66ec3fc9df4b52b4d6f24fc8508fd3",
        indexName: "tikz.dev",
        appId: "Q70NNMA9GC",
        container: "#search",
      });
    </script>
  </body>
</html>
